
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>HomeWork #1 Machine Learning &#8212; My Jupyter Book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Homework no.2" href="../HW2/main.html" />
    <link rel="prev" title="Homework no.1 Machine Learning" href="README.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">My Jupyter Book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Machine Learning Homeworks
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="README.html">
   Homework no.1 Machine Learning
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     HomeWork #1 Machine Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../HW2/main.html">
   Homework no.2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../HW3/main.html">
   Homework no.3 Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../HW4/main.html">
   Homework no.4 Machine Learning
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/HW1/main.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/HW1/main.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q2">
   Q2
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-b">
     (a, b)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c">
     (c)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d">
     (d)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#f">
     (f)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q3">
   Q3
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a">
     (a)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b">
     (b)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q4">
   Q4
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     (a)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     (b)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     (c)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#validation-schemes">
   Validation schemes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-k-fold-cross-validation">
     (a) K-fold Cross Validation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-bootstraping">
     (b) Bootstraping
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q7">
   Q7
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     (f)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#g">
     (g)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#h">
     (h)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i">
     (i)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q8">
   Q8
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-1">
     Part 1
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       (a)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       (b)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       (c)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       (d)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-2">
     Part 2
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       (a)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       (b)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#c-d">
       (c, d)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-3">
     Part 3
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-online-linear-regression">
       (a) Online Linear Regression
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       (b)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id12">
       (c)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       (d)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#d-2">
       (d.2)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-4">
     Part 4
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       (a)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id15">
       (b)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id16">
       (c)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id17">
       (d)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>HomeWork #1 Machine Learning</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q2">
   Q2
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-b">
     (a, b)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c">
     (c)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d">
     (d)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#f">
     (f)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q3">
   Q3
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a">
     (a)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b">
     (b)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q4">
   Q4
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     (a)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     (b)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     (c)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#validation-schemes">
   Validation schemes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-k-fold-cross-validation">
     (a) K-fold Cross Validation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-bootstraping">
     (b) Bootstraping
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q7">
   Q7
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     (f)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#g">
     (g)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#h">
     (h)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#i">
     (i)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q8">
   Q8
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-1">
     Part 1
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       (a)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       (b)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       (c)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       (d)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-2">
     Part 2
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       (a)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       (b)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#c-d">
       (c, d)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-3">
     Part 3
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-online-linear-regression">
       (a) Online Linear Regression
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       (b)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id12">
       (c)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       (d)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#d-2">
       (d.2)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-4">
     Part 4
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       (a)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id15">
       (b)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id16">
       (c)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id17">
       (d)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="homework-1-machine-learning">
<h1>HomeWork #1 Machine Learning<a class="headerlink" href="#homework-1-machine-learning" title="Permalink to this headline">#</a></h1>
<p>Stu. name: Seyed Mohammad Amin Dadgar <br>
Stu. no: 4003624016</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">scipy</span>
</pre></div>
</div>
</div>
</div>
<section id="q2">
<h2>Q2<a class="headerlink" href="#q2" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## column names are used from ```pima-indians-diabetes.name``` file</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pregnancy_count&#39;</span><span class="p">,</span> <span class="s1">&#39;glucose_test&#39;</span><span class="p">,</span> <span class="s1">&#39;blood_pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;triceps_thickness&#39;</span><span class="p">,</span> <span class="s1">&#39;2h_insulin&#39;</span><span class="p">,</span> <span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;pedi&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hw1_data/pima/pima-indians-diabetes.data&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span> <span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>mass</th>
      <th>pedi</th>
      <th>age</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>148</td>
      <td>72</td>
      <td>35</td>
      <td>0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>85</td>
      <td>66</td>
      <td>29</td>
      <td>0</td>
      <td>26.6</td>
      <td>0.351</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>183</td>
      <td>64</td>
      <td>0</td>
      <td>0</td>
      <td>23.3</td>
      <td>0.672</td>
      <td>32</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>89</td>
      <td>66</td>
      <td>23</td>
      <td>94</td>
      <td>28.1</td>
      <td>0.167</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>137</td>
      <td>40</td>
      <td>35</td>
      <td>168</td>
      <td>43.1</td>
      <td>2.288</td>
      <td>33</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## save the dataset in the right format with its columns for other usages </span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;hw1_data/processed/pima-indians-diabetes.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="a-b">
<h3>(a, b)<a class="headerlink" href="#a-b" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>mass</th>
      <th>pedi</th>
      <th>age</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>768.000000</td>
      <td>768.000000</td>
      <td>768.000000</td>
      <td>768.000000</td>
      <td>768.000000</td>
      <td>768.000000</td>
      <td>768.000000</td>
      <td>768.000000</td>
      <td>768.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.845052</td>
      <td>120.894531</td>
      <td>69.105469</td>
      <td>20.536458</td>
      <td>79.799479</td>
      <td>31.992578</td>
      <td>0.471876</td>
      <td>33.240885</td>
      <td>0.348958</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3.369578</td>
      <td>31.972618</td>
      <td>19.355807</td>
      <td>15.952218</td>
      <td>115.244002</td>
      <td>7.884160</td>
      <td>0.331329</td>
      <td>11.760232</td>
      <td>0.476951</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.078000</td>
      <td>21.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.000000</td>
      <td>99.000000</td>
      <td>62.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>27.300000</td>
      <td>0.243750</td>
      <td>24.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.000000</td>
      <td>117.000000</td>
      <td>72.000000</td>
      <td>23.000000</td>
      <td>30.500000</td>
      <td>32.000000</td>
      <td>0.372500</td>
      <td>29.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>6.000000</td>
      <td>140.250000</td>
      <td>80.000000</td>
      <td>32.000000</td>
      <td>127.250000</td>
      <td>36.600000</td>
      <td>0.626250</td>
      <td>41.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>17.000000</td>
      <td>199.000000</td>
      <td>122.000000</td>
      <td>99.000000</td>
      <td>846.000000</td>
      <td>67.100000</td>
      <td>2.420000</td>
      <td>81.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## the variance of each attribute</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">var</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;variance&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pregnancy_count</th>
      <td>11.354056</td>
    </tr>
    <tr>
      <th>glucose_test</th>
      <td>1022.248314</td>
    </tr>
    <tr>
      <th>blood_pressure</th>
      <td>374.647271</td>
    </tr>
    <tr>
      <th>triceps_thickness</th>
      <td>254.473245</td>
    </tr>
    <tr>
      <th>2h_insulin</th>
      <td>13281.180078</td>
    </tr>
    <tr>
      <th>mass</th>
      <td>62.159984</td>
    </tr>
    <tr>
      <th>pedi</th>
      <td>0.109779</td>
    </tr>
    <tr>
      <th>age</th>
      <td>138.303046</td>
    </tr>
    <tr>
      <th>label</th>
      <td>0.227483</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="c">
<h3>(c)<a class="headerlink" href="#c" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Calculating the correlation between 8 attributes (label is outcluded)</span>
<span class="n">attr_corr</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">attr_corr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>mass</th>
      <th>pedi</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pregnancy_count</th>
      <td>1.000000</td>
      <td>0.129459</td>
      <td>0.141282</td>
      <td>-0.081672</td>
      <td>-0.073535</td>
      <td>0.017683</td>
      <td>-0.033523</td>
      <td>0.544341</td>
    </tr>
    <tr>
      <th>glucose_test</th>
      <td>0.129459</td>
      <td>1.000000</td>
      <td>0.152590</td>
      <td>0.057328</td>
      <td>0.331357</td>
      <td>0.221071</td>
      <td>0.137337</td>
      <td>0.263514</td>
    </tr>
    <tr>
      <th>blood_pressure</th>
      <td>0.141282</td>
      <td>0.152590</td>
      <td>1.000000</td>
      <td>0.207371</td>
      <td>0.088933</td>
      <td>0.281805</td>
      <td>0.041265</td>
      <td>0.239528</td>
    </tr>
    <tr>
      <th>triceps_thickness</th>
      <td>-0.081672</td>
      <td>0.057328</td>
      <td>0.207371</td>
      <td>1.000000</td>
      <td>0.436783</td>
      <td>0.392573</td>
      <td>0.183928</td>
      <td>-0.113970</td>
    </tr>
    <tr>
      <th>2h_insulin</th>
      <td>-0.073535</td>
      <td>0.331357</td>
      <td>0.088933</td>
      <td>0.436783</td>
      <td>1.000000</td>
      <td>0.197859</td>
      <td>0.185071</td>
      <td>-0.042163</td>
    </tr>
    <tr>
      <th>mass</th>
      <td>0.017683</td>
      <td>0.221071</td>
      <td>0.281805</td>
      <td>0.392573</td>
      <td>0.197859</td>
      <td>1.000000</td>
      <td>0.140647</td>
      <td>0.036242</td>
    </tr>
    <tr>
      <th>pedi</th>
      <td>-0.033523</td>
      <td>0.137337</td>
      <td>0.041265</td>
      <td>0.183928</td>
      <td>0.185071</td>
      <td>0.140647</td>
      <td>1.000000</td>
      <td>0.033561</td>
    </tr>
    <tr>
      <th>age</th>
      <td>0.544341</td>
      <td>0.263514</td>
      <td>0.239528</td>
      <td>-0.113970</td>
      <td>-0.042163</td>
      <td>0.036242</td>
      <td>0.033561</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## showing the heatmap for better visualization</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">attr_corr</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_10_0.png" src="../_images/main_10_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">label_corr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">corrwith</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">label</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">label_corr</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;correlation&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>correlation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>label</th>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>glucose_test</th>
      <td>0.466581</td>
    </tr>
    <tr>
      <th>mass</th>
      <td>0.292695</td>
    </tr>
    <tr>
      <th>age</th>
      <td>0.238356</td>
    </tr>
    <tr>
      <th>pregnancy_count</th>
      <td>0.221898</td>
    </tr>
    <tr>
      <th>pedi</th>
      <td>0.173844</td>
    </tr>
    <tr>
      <th>2h_insulin</th>
      <td>0.130548</td>
    </tr>
    <tr>
      <th>triceps_thickness</th>
      <td>0.074752</td>
    </tr>
    <tr>
      <th>blood_pressure</th>
      <td>0.065068</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>What we will find out from the correlation matrix with label is the most useful feature (Or the most affective feature ) for the label is <em>glucose_test</em>. To find why it is the most helpful attribute we can review the correlation formula with below
\begin{equation}
correlation = \frac{covariance(x,y)}{var(x) var(y)}
\end{equation}
And with this equation it’s obvious that if coefficient is positive then the effect of can be if x increases then y is increased. By this reason the biggest value for correlation of a feature with lable can be intrepreted the most helpful feature (attribute).</p>
<p>Also to explain the correlation value of one we can say that, x variable is the same as y in eq(1).</p>
</section>
<section id="d">
<h3>(d)<a class="headerlink" href="#d" title="Permalink to this headline">#</a></h3>
<p>If 2 attributes are fully correlated then using both in prediction may make bias and the prediction result would not be helpful. The alternative and the better way for prediction is to use one of the attributes.</p>
</section>
<section id="f">
<h3>(f)<a class="headerlink" href="#f" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">glucose_test</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Plasma glucose concentration a 2 hours</span><span class="se">\n</span><span class="s1"> in an oral glucose tolerance test&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Body mass index </span><span class="se">\n</span><span class="s1">(weight in kg/(height in m)^2)&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">pregnancy_count</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Number of times pregnant&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">pedi</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Diabetes pedigree function&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;2h_insulin&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;2-Hour serum insulin (mu U/ml)&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">triceps_thickness</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Triceps skin fold thickness (mm)&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">blood_pressure</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Diastolic blood pressure (mm Hg)&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Class variable (0 or 1)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/amin/.local/lib/python3.8/site-packages/seaborn/distributions.py:2619: FutureWarning: `distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms).
  warnings.warn(msg, FutureWarning)
/home/amin/.local/lib/python3.8/site-packages/seaborn/distributions.py:2619: FutureWarning: `distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms).
  warnings.warn(msg, FutureWarning)
/home/amin/.local/lib/python3.8/site-packages/seaborn/distributions.py:2619: FutureWarning: `distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms).
  warnings.warn(msg, FutureWarning)
/home/amin/.local/lib/python3.8/site-packages/seaborn/distributions.py:2619: FutureWarning: `distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms).
  warnings.warn(msg, FutureWarning)
/home/amin/.local/lib/python3.8/site-packages/seaborn/distributions.py:2619: FutureWarning: `distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms).
  warnings.warn(msg, FutureWarning)
/home/amin/.local/lib/python3.8/site-packages/seaborn/distributions.py:2619: FutureWarning: `distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms).
  warnings.warn(msg, FutureWarning)
/home/amin/.local/lib/python3.8/site-packages/seaborn/distributions.py:2619: FutureWarning: `distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms).
  warnings.warn(msg, FutureWarning)
/home/amin/.local/lib/python3.8/site-packages/seaborn/distributions.py:2619: FutureWarning: `distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms).
  warnings.warn(msg, FutureWarning)
/home/amin/.local/lib/python3.8/site-packages/seaborn/distributions.py:2619: FutureWarning: `distplot` is a deprecated function and will be removed in a future version. Please adapt your code to use either `displot` (a figure-level function with similar flexibility) or `histplot` (an axes-level function for histograms).
  warnings.warn(msg, FutureWarning)
</pre></div>
</div>
<img alt="../_images/main_16_1.png" src="../_images/main_16_1.png" />
</div>
</div>
<p>If we look closely we can say that body mass index and the plasma glucose is the most similar to normal distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>



<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">glucose_test</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;glucose_test And mass&#39;</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;mass And age&#39;</span><span class="p">])</span>


<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">pregnancy_count</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;age And pregnancy_count&#39;</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">pregnancy_count</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">pedi</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;pregnancy_count And predi&#39;</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">pedi</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;2h_insulin&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;predi And 2h_insulin&#39;</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;2h_insulin&#39;</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">triceps_thickness</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;2h_insulin And triceps_thickness&#39;</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">triceps_thickness</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">blood_pressure</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;triceps_thickness And blood_pressure&#39;</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/amin/.local/lib/python3.8/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(
/home/amin/.local/lib/python3.8/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(
/home/amin/.local/lib/python3.8/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(
/home/amin/.local/lib/python3.8/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(
/home/amin/.local/lib/python3.8/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(
/home/amin/.local/lib/python3.8/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(
/home/amin/.local/lib/python3.8/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(
</pre></div>
</div>
<img alt="../_images/main_18_1.png" src="../_images/main_18_1.png" />
</div>
</div>
<p>It is obvious that for (pregnancy_count, predi) and (age, pregnancy_count) we can say they have linear dependency.</p>
</section>
</section>
<section id="q3">
<h2>Q3<a class="headerlink" href="#q3" title="Permalink to this headline">#</a></h2>
<section id="a">
<h3>(a)<a class="headerlink" href="#a" title="Permalink to this headline">#</a></h3>
<p>create a normalize function using the equation below
\begin{equation}
x_{norm} = \frac{x- \mu_x}{\sigma_x}
\end{equation}
normalize the third attribute on pima dataset, then report the values for the first 5 entries on dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## column names are used from ```pima-indians-diabetes.name``` file</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pregnancy_count&#39;</span><span class="p">,</span> <span class="s1">&#39;glucose_test&#39;</span><span class="p">,</span> <span class="s1">&#39;blood_pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;triceps_thickness&#39;</span><span class="p">,</span> <span class="s1">&#39;2h_insulin&#39;</span><span class="p">,</span> <span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;pedi&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hw1_data/pima/pima-indians-diabetes.data&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span> <span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>mass</th>
      <th>pedi</th>
      <th>age</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>148</td>
      <td>72</td>
      <td>35</td>
      <td>0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>85</td>
      <td>66</td>
      <td>29</td>
      <td>0</td>
      <td>26.6</td>
      <td>0.351</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>183</td>
      <td>64</td>
      <td>0</td>
      <td>0</td>
      <td>23.3</td>
      <td>0.672</td>
      <td>32</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>89</td>
      <td>66</td>
      <td>23</td>
      <td>94</td>
      <td>28.1</td>
      <td>0.167</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>137</td>
      <td>40</td>
      <td>35</td>
      <td>168</td>
      <td>43.1</td>
      <td>2.288</td>
      <td>33</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="n">attrib</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    normalize an attribute using its mean and standard deviation</span>

<span class="sd">    INPUTS:</span>
<span class="sd">    --------</span>
<span class="sd">    attrib: a pandas series, the original unormalized attribute</span>

<span class="sd">    OUTPUT:</span>
<span class="sd">    --------</span>
<span class="sd">    normalized:  the normalized attribute</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mu</span> <span class="o">=</span> <span class="n">attrib</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">attrib</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

    <span class="n">normalized</span> <span class="o">=</span> <span class="p">(</span><span class="n">attrib</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma</span>
    <span class="k">return</span> <span class="n">normalized</span>

<span class="c1">## third attribute is blood pressure</span>
<span class="n">blood_pressure_norm</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">blood_pressure</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">blood_pressure_norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>blood_pressure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.149543</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.160441</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.263769</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.160441</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.503707</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>763</th>
      <td>0.356200</td>
    </tr>
    <tr>
      <th>764</th>
      <td>0.046215</td>
    </tr>
    <tr>
      <th>765</th>
      <td>0.149543</td>
    </tr>
    <tr>
      <th>766</th>
      <td>-0.470426</td>
    </tr>
    <tr>
      <th>767</th>
      <td>0.046215</td>
    </tr>
  </tbody>
</table>
<p>768 rows × 1 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## normalize first 5 attribute of the function</span>
<span class="n">normalize</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;pregnancy_count&#39;</span><span class="p">,</span> <span class="s1">&#39;glucose_test&#39;</span><span class="p">,</span> <span class="s1">&#39;blood_pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;triceps_thickness&#39;</span><span class="p">,</span> <span class="s1">&#39;2h_insulin&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.639530</td>
      <td>0.847771</td>
      <td>0.149543</td>
      <td>0.906679</td>
      <td>-0.692439</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.844335</td>
      <td>-1.122665</td>
      <td>-0.160441</td>
      <td>0.530556</td>
      <td>-0.692439</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.233077</td>
      <td>1.942458</td>
      <td>-0.263769</td>
      <td>-1.287373</td>
      <td>-0.692439</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.844335</td>
      <td>-0.997558</td>
      <td>-0.160441</td>
      <td>0.154433</td>
      <td>0.123221</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.141108</td>
      <td>0.503727</td>
      <td>-1.503707</td>
      <td>0.906679</td>
      <td>0.765337</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>763</th>
      <td>1.826623</td>
      <td>-0.622237</td>
      <td>0.356200</td>
      <td>1.721613</td>
      <td>0.869464</td>
    </tr>
    <tr>
      <th>764</th>
      <td>-0.547562</td>
      <td>0.034575</td>
      <td>0.046215</td>
      <td>0.405181</td>
      <td>-0.692439</td>
    </tr>
    <tr>
      <th>765</th>
      <td>0.342757</td>
      <td>0.003299</td>
      <td>0.149543</td>
      <td>0.154433</td>
      <td>0.279412</td>
    </tr>
    <tr>
      <th>766</th>
      <td>-0.844335</td>
      <td>0.159683</td>
      <td>-0.470426</td>
      <td>-1.287373</td>
      <td>-0.692439</td>
    </tr>
    <tr>
      <th>767</th>
      <td>-0.844335</td>
      <td>-0.872451</td>
      <td>0.046215</td>
      <td>0.655930</td>
      <td>-0.692439</td>
    </tr>
  </tbody>
</table>
<p>768 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;pregnancy_count&#39;</span><span class="p">,</span> <span class="s1">&#39;glucose_test&#39;</span><span class="p">,</span> <span class="s1">&#39;triceps_thickness&#39;</span><span class="p">,</span> <span class="s1">&#39;2h_insulin&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;normalized_blood_pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blood_pressure_norm</span>
<span class="n">new_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>normalized_blood_pressure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>148</td>
      <td>35</td>
      <td>0</td>
      <td>0.149543</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>85</td>
      <td>29</td>
      <td>0</td>
      <td>-0.160441</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>183</td>
      <td>0</td>
      <td>0</td>
      <td>-0.263769</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>89</td>
      <td>23</td>
      <td>94</td>
      <td>-0.160441</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>137</td>
      <td>35</td>
      <td>168</td>
      <td>-1.503707</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="b">
<h3>(b)<a class="headerlink" href="#b" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">discretize_attribute</span><span class="p">(</span><span class="n">attribute</span> <span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    descritize a continues attribute and make the intervals the bins size</span>

<span class="sd">    INPUTS:</span>
<span class="sd">    --------</span>
<span class="sd">    attribute: pandas series of **one column**</span>
<span class="sd">    bins:  the interval space for each class, default is 10</span>
<span class="sd">    verbose: print the each stage output if True, default is False</span>

<span class="sd">    OUTPUT:</span>
<span class="sd">    --------</span>
<span class="sd">    pandas dataframe of the discrite values of an attribute </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">attribute</span><span class="o">.</span><span class="n">columns</span><span class="p">)))</span>

    <span class="c1">## each bin length </span>
    <span class="n">bin_len</span> <span class="o">=</span> <span class="n">attribute</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="n">bins</span>
    <span class="c1"># bin_len = int(bin_len)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;bin length: </span><span class="si">{</span><span class="n">bin_len</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="c1">## counter to iterate the intervals</span>
    <span class="n">interval</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">interval</span> <span class="o">&lt;</span> <span class="n">attribute</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
        <span class="c1">## find the attributes within the interval and drop na (NAN values are thoes who are not in the interval)</span>
        <span class="n">conditioned_data</span> <span class="o">=</span> <span class="n">attribute</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">interval</span> <span class="o">&lt;</span> <span class="n">attribute</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">attribute</span> <span class="o">&lt;</span> <span class="n">interval</span> <span class="o">+</span> <span class="n">bin_len</span><span class="p">))</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
        
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">conditioned_data</span><span class="p">)</span>
        
        <span class="c1">## To discretize the attributes set all the values to the mean of interval we have</span>
        <span class="n">conditioned_data</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">interval</span> <span class="o">+</span> <span class="n">bin_len</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="nb">list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">conditioned_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span> <span class="p">)</span>
        <span class="c1">## iterate the next intervals</span>
        <span class="n">interval</span> <span class="o">+=</span> <span class="n">bin_len</span>


    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">attribute</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
    

<span class="n">attrib</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;blood_pressure&#39;</span><span class="p">]]</span>
<span class="n">df_discrete_blood_pressure</span> <span class="o">=</span>  <span class="n">discretize_attribute</span><span class="p">(</span><span class="n">attrib</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">df_discrete_blood_pressure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>blood_pressure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12.200000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.299999</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18.299999</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24.400000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>728</th>
      <td>61.000000</td>
    </tr>
    <tr>
      <th>729</th>
      <td>61.000000</td>
    </tr>
    <tr>
      <th>730</th>
      <td>61.000000</td>
    </tr>
    <tr>
      <th>731</th>
      <td>61.000000</td>
    </tr>
    <tr>
      <th>732</th>
      <td>61.000000</td>
    </tr>
  </tbody>
</table>
<p>733 rows × 1 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df_discrete_blood_pressure</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_28_0.png" src="../_images/main_28_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_discrete_pregnancy</span> <span class="o">=</span> <span class="n">discretize_attribute</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;pregnancy_count&#39;</span><span class="p">]],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">df_discrete_glucose_test</span> <span class="o">=</span> <span class="n">discretize_attribute</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;glucose_test&#39;</span><span class="p">]],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">df_discrete_triceps_thickness</span> <span class="o">=</span> <span class="n">discretize_attribute</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;triceps_thickness&#39;</span><span class="p">]],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">df_discrete_2h_insulin</span> <span class="o">=</span> <span class="n">discretize_attribute</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;2h_insulin&#39;</span><span class="p">]],</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df_discrete_blood_pressure</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df_discrete_2h_insulin</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df_discrete_glucose_test</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df_discrete_pregnancy</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df_discrete_triceps_thickness</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_29_0.png" src="../_images/main_29_0.png" />
</div>
</div>
</section>
</section>
<section id="q4">
<h2>Q4<a class="headerlink" href="#q4" title="Permalink to this headline">#</a></h2>
<section id="id1">
<h3>(a)<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## column names are used from ```pima-indians-diabetes.name``` file</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pregnancy_count&#39;</span><span class="p">,</span> <span class="s1">&#39;glucose_test&#39;</span><span class="p">,</span> <span class="s1">&#39;blood_pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;triceps_thickness&#39;</span><span class="p">,</span> <span class="s1">&#39;2h_insulin&#39;</span><span class="p">,</span> <span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;pedi&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hw1_data/pima/pima-indians-diabetes.data&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span> <span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>mass</th>
      <th>pedi</th>
      <th>age</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>148</td>
      <td>72</td>
      <td>35</td>
      <td>0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>85</td>
      <td>66</td>
      <td>29</td>
      <td>0</td>
      <td>26.6</td>
      <td>0.351</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>183</td>
      <td>64</td>
      <td>0</td>
      <td>0</td>
      <td>23.3</td>
      <td>0.672</td>
      <td>32</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>89</td>
      <td>66</td>
      <td>23</td>
      <td>94</td>
      <td>28.1</td>
      <td>0.167</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>137</td>
      <td>40</td>
      <td>35</td>
      <td>168</td>
      <td>43.1</td>
      <td>2.288</td>
      <td>33</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_class_0</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_class_1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_class_0</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>mass</th>
      <th>pedi</th>
      <th>age</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>500.000000</td>
      <td>500.0000</td>
      <td>500.000000</td>
      <td>500.000000</td>
      <td>500.000000</td>
      <td>500.000000</td>
      <td>500.000000</td>
      <td>500.000000</td>
      <td>500.0</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.298000</td>
      <td>109.9800</td>
      <td>68.184000</td>
      <td>19.664000</td>
      <td>68.792000</td>
      <td>30.304200</td>
      <td>0.429734</td>
      <td>31.190000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3.017185</td>
      <td>26.1412</td>
      <td>18.063075</td>
      <td>14.889947</td>
      <td>98.865289</td>
      <td>7.689855</td>
      <td>0.299085</td>
      <td>11.667655</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.078000</td>
      <td>21.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.000000</td>
      <td>93.0000</td>
      <td>62.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>25.400000</td>
      <td>0.229750</td>
      <td>23.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.000000</td>
      <td>107.0000</td>
      <td>70.000000</td>
      <td>21.000000</td>
      <td>39.000000</td>
      <td>30.050000</td>
      <td>0.336000</td>
      <td>27.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>5.000000</td>
      <td>125.0000</td>
      <td>78.000000</td>
      <td>31.000000</td>
      <td>105.000000</td>
      <td>35.300000</td>
      <td>0.561750</td>
      <td>37.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>max</th>
      <td>13.000000</td>
      <td>197.0000</td>
      <td>122.000000</td>
      <td>60.000000</td>
      <td>744.000000</td>
      <td>57.300000</td>
      <td>2.329000</td>
      <td>81.000000</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_class_1</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>mass</th>
      <th>pedi</th>
      <th>age</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>268.000000</td>
      <td>268.000000</td>
      <td>268.000000</td>
      <td>268.000000</td>
      <td>268.000000</td>
      <td>268.000000</td>
      <td>268.000000</td>
      <td>268.000000</td>
      <td>268.0</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4.865672</td>
      <td>141.257463</td>
      <td>70.824627</td>
      <td>22.164179</td>
      <td>100.335821</td>
      <td>35.142537</td>
      <td>0.550500</td>
      <td>37.067164</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3.741239</td>
      <td>31.939622</td>
      <td>21.491812</td>
      <td>17.679711</td>
      <td>138.689125</td>
      <td>7.262967</td>
      <td>0.372354</td>
      <td>10.968254</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.088000</td>
      <td>21.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.750000</td>
      <td>119.000000</td>
      <td>66.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>30.800000</td>
      <td>0.262500</td>
      <td>28.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>4.000000</td>
      <td>140.000000</td>
      <td>74.000000</td>
      <td>27.000000</td>
      <td>0.000000</td>
      <td>34.250000</td>
      <td>0.449000</td>
      <td>36.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>8.000000</td>
      <td>167.000000</td>
      <td>82.000000</td>
      <td>36.000000</td>
      <td>167.250000</td>
      <td>38.775000</td>
      <td>0.728000</td>
      <td>44.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>max</th>
      <td>17.000000</td>
      <td>199.000000</td>
      <td>114.000000</td>
      <td>99.000000</td>
      <td>846.000000</td>
      <td>67.100000</td>
      <td>2.420000</td>
      <td>70.000000</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id2">
<h3>(b)<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## we would choose randomly an index with the probability of 66% </span>
<span class="k">def</span> <span class="nf">divideset1</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.66</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    divide the dataset into train and test with a probability</span>

<span class="sd">    INPUTS:</span>
<span class="sd">    --------</span>
<span class="sd">    df: pandas dataframe, the dataset we want to split</span>
<span class="sd">    prob: the probability to divide the dataset, default is 0.66</span>

<span class="sd">    OUTPUTS:</span>
<span class="sd">    ---------</span>
<span class="sd">    train: pandas dataframe, the portion of the dataset for train</span>
<span class="sd">    test: pandas dataframe, the portion of the dataset for test</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## copy the dataframe to ensure there is no problem</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">trainset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">testset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="c1">## iterate over dataset and select each row as train or test</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)):</span>
        <span class="c1">## get the row</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">probability</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="c1">## if the probability range is between 0 and chosen prob</span>
        <span class="k">if</span> <span class="n">probability</span> <span class="o">-</span> <span class="n">prob</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">trainset</span> <span class="o">=</span> <span class="n">trainset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">testset</span> <span class="o">=</span> <span class="n">testset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">trainset</span><span class="p">,</span> <span class="n">testset</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_split</span><span class="p">,</span> <span class="n">test_split</span> <span class="o">=</span> <span class="n">divideset1</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">train_split</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>mass</th>
      <th>pedi</th>
      <th>age</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.0</td>
      <td>148.0</td>
      <td>72.0</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>6.0</td>
      <td>148.0</td>
      <td>72.0</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>6.0</td>
      <td>148.0</td>
      <td>72.0</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>6.0</td>
      <td>148.0</td>
      <td>72.0</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>6.0</td>
      <td>148.0</td>
      <td>72.0</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>6.0</td>
      <td>148.0</td>
      <td>72.0</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>6.0</td>
      <td>148.0</td>
      <td>72.0</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>6.0</td>
      <td>148.0</td>
      <td>72.0</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>6.0</td>
      <td>148.0</td>
      <td>72.0</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>6.0</td>
      <td>148.0</td>
      <td>72.0</td>
      <td>35.0</td>
      <td>0.0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>249 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## check the average training split size with the count of times</span>
<span class="n">times</span> <span class="o">=</span> <span class="mi">20</span>
<span class="c1">## save all lengths</span>
<span class="n">lengths</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
    <span class="n">training_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">divideset1</span><span class="p">(</span><span class="n">df</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Iteration </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> - training length: </span><span class="si">{</span><span class="n">training_len</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">lengths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">training_len</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Average Lengths: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration 0 - training length: 255
Iteration 1 - training length: 256
Iteration 2 - training length: 273
Iteration 3 - training length: 250
Iteration 4 - training length: 244
Iteration 5 - training length: 237
Iteration 6 - training length: 250
Iteration 7 - training length: 247
Iteration 8 - training length: 257
Iteration 9 - training length: 259
Iteration 10 - training length: 240
Iteration 11 - training length: 238
Iteration 12 - training length: 270
Iteration 13 - training length: 267
Iteration 14 - training length: 248
Iteration 15 - training length: 248
Iteration 16 - training length: 273
Iteration 17 - training length: 257
Iteration 18 - training length: 259
Iteration 19 - training length: 247
------------------------------------------
Average Lengths: 253.75
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3>(c)<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">divideset2</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fraction</span> <span class="o">=</span> <span class="mf">0.66</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Divide the dataset into train and test with fixed size every run</span>

<span class="sd">    INPUTS:</span>
<span class="sd">    ---------</span>
<span class="sd">    df: pandas dataframe, the dataset that is going to be splitted</span>
<span class="sd">    fraction: the value to divide the dataset, default is 0.66</span>

<span class="sd">    OUTPUTS:</span>
<span class="sd">    ---------</span>
<span class="sd">    train: pandas dataframe, the portion of the dataset for train</span>
<span class="sd">    test: pandas dataframe, the portion of the dataset for test</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.66</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span>

<span class="n">train2</span><span class="p">,</span> <span class="n">test2</span> <span class="o">=</span> <span class="n">divideset2</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">train2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------------&#39;</span><span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     pregnancy_count  glucose_test  blood_pressure  triceps_thickness  \
630                7           114              64                  0   
136                0           100              70                 26   
468                8           120               0                  0   
728                2           175              88                  0   
382                1           109              60                  8   

     2h_insulin  mass   pedi  age  label  
630           0  27.4  0.732   34      1  
136          50  30.8  0.597   21      0  
468           0  30.0  0.183   38      1  
728           0  22.9  0.326   22      0  
382         182  25.4  0.947   21      0  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    pregnancy_count  glucose_test  blood_pressure  triceps_thickness  \
0                 6           148              72                 35   
2                 8           183              64                  0   
3                 1            89              66                 23   
6                 3            78              50                 32   
11               10           168              74                  0   

    2h_insulin  mass   pedi  age  label  
0            0  33.6  0.627   50      1  
2            0  23.3  0.672   32      1  
3           94  28.1  0.167   21      0  
6           88  31.0  0.248   26      1  
11           0  38.0  0.537   34      1  
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="validation-schemes">
<h2>Validation schemes<a class="headerlink" href="#validation-schemes" title="Permalink to this headline">#</a></h2>
<section id="a-k-fold-cross-validation">
<h3>(a) K-fold Cross Validation<a class="headerlink" href="#a-k-fold-cross-validation" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">kfold_crossvalidation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    K-fold cross validation </span>
<span class="sd">    Note: test data is equivalent the validation data in normal machine learning models (Because it is used to evaluate one model)</span>

<span class="sd">    INPUTS:</span>
<span class="sd">    --------</span>
<span class="sd">    data: pandas dataframe containing feature vectors as rows</span>
<span class="sd">    k: positive integer, the number of folds</span>
<span class="sd">    m: target output </span>
<span class="sd">    train_split:  the fraction of data that is used to split for training, default is 0.7</span>

<span class="sd">    OUTPUTS:</span>
<span class="sd">    ---------</span>
<span class="sd">    training_data: multi-dimensional array of training data, each index contains the dataset for K-fold number</span>
<span class="sd">    test_data: multi-dimensional array of test data, each ```index+1``` contains the dataset for each K-fold number</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## get the length of data to split it</span>
    <span class="n">dataframe_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1">## find the length of each split</span>
    <span class="c1"># training_size = int(dataframe_size * train_split)</span>
    <span class="c1"># test_size = dataframe_size - training_size</span>

    <span class="c1">## empty arrays to save data into it</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">## find the split size</span>
    <span class="n">split</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dataframe_size</span> <span class="o">/</span> <span class="n">k</span><span class="p">)</span>

    <span class="c1">## split the data into k-fold and add the folds into the arrays</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">start_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">split</span><span class="p">)</span>
        <span class="n">end_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">split</span><span class="p">)</span>

        <span class="n">test</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1">## add the label column to corresponding index</span>
        <span class="n">test</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span> <span class="n">end_idx</span><span class="p">]</span>
        
        
        <span class="c1">## choose other part of dataset as train</span>
        <span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">test</span><span class="p">])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">train</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
        
        <span class="n">training_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
        <span class="n">test_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">test_data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">training_folds</span><span class="p">,</span> <span class="n">test_folds</span> <span class="o">=</span> <span class="n">kfold_crossvalidation</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">label</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## check the K=1 test data fold</span>
<span class="n">test_folds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>mass</th>
      <th>pedi</th>
      <th>age</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>148</td>
      <td>72</td>
      <td>35</td>
      <td>0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>85</td>
      <td>66</td>
      <td>29</td>
      <td>0</td>
      <td>26.6</td>
      <td>0.351</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>183</td>
      <td>64</td>
      <td>0</td>
      <td>0</td>
      <td>23.3</td>
      <td>0.672</td>
      <td>32</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>89</td>
      <td>66</td>
      <td>23</td>
      <td>94</td>
      <td>28.1</td>
      <td>0.167</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>137</td>
      <td>40</td>
      <td>35</td>
      <td>168</td>
      <td>43.1</td>
      <td>2.288</td>
      <td>33</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>148</th>
      <td>5</td>
      <td>147</td>
      <td>78</td>
      <td>0</td>
      <td>0</td>
      <td>33.7</td>
      <td>0.218</td>
      <td>65</td>
      <td>0</td>
    </tr>
    <tr>
      <th>149</th>
      <td>2</td>
      <td>90</td>
      <td>70</td>
      <td>17</td>
      <td>0</td>
      <td>27.3</td>
      <td>0.085</td>
      <td>22</td>
      <td>0</td>
    </tr>
    <tr>
      <th>150</th>
      <td>1</td>
      <td>136</td>
      <td>74</td>
      <td>50</td>
      <td>204</td>
      <td>37.4</td>
      <td>0.399</td>
      <td>24</td>
      <td>0</td>
    </tr>
    <tr>
      <th>151</th>
      <td>4</td>
      <td>114</td>
      <td>65</td>
      <td>0</td>
      <td>0</td>
      <td>21.9</td>
      <td>0.432</td>
      <td>37</td>
      <td>0</td>
    </tr>
    <tr>
      <th>152</th>
      <td>9</td>
      <td>156</td>
      <td>86</td>
      <td>28</td>
      <td>155</td>
      <td>34.3</td>
      <td>1.189</td>
      <td>42</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>153 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## check K=1 fold training set </span>
<span class="n">training_folds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>mass</th>
      <th>pedi</th>
      <th>age</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>153</th>
      <td>1</td>
      <td>153</td>
      <td>82</td>
      <td>42</td>
      <td>485</td>
      <td>40.6</td>
      <td>0.687</td>
      <td>23</td>
      <td>0</td>
    </tr>
    <tr>
      <th>154</th>
      <td>8</td>
      <td>188</td>
      <td>78</td>
      <td>0</td>
      <td>0</td>
      <td>47.9</td>
      <td>0.137</td>
      <td>43</td>
      <td>1</td>
    </tr>
    <tr>
      <th>155</th>
      <td>7</td>
      <td>152</td>
      <td>88</td>
      <td>44</td>
      <td>0</td>
      <td>50.0</td>
      <td>0.337</td>
      <td>36</td>
      <td>1</td>
    </tr>
    <tr>
      <th>156</th>
      <td>2</td>
      <td>99</td>
      <td>52</td>
      <td>15</td>
      <td>94</td>
      <td>24.6</td>
      <td>0.637</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>157</th>
      <td>1</td>
      <td>109</td>
      <td>56</td>
      <td>21</td>
      <td>135</td>
      <td>25.2</td>
      <td>0.833</td>
      <td>23</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>763</th>
      <td>10</td>
      <td>101</td>
      <td>76</td>
      <td>48</td>
      <td>180</td>
      <td>32.9</td>
      <td>0.171</td>
      <td>63</td>
      <td>0</td>
    </tr>
    <tr>
      <th>764</th>
      <td>2</td>
      <td>122</td>
      <td>70</td>
      <td>27</td>
      <td>0</td>
      <td>36.8</td>
      <td>0.340</td>
      <td>27</td>
      <td>0</td>
    </tr>
    <tr>
      <th>765</th>
      <td>5</td>
      <td>121</td>
      <td>72</td>
      <td>23</td>
      <td>112</td>
      <td>26.2</td>
      <td>0.245</td>
      <td>30</td>
      <td>0</td>
    </tr>
    <tr>
      <th>766</th>
      <td>1</td>
      <td>126</td>
      <td>60</td>
      <td>0</td>
      <td>0</td>
      <td>30.1</td>
      <td>0.349</td>
      <td>47</td>
      <td>1</td>
    </tr>
    <tr>
      <th>767</th>
      <td>1</td>
      <td>93</td>
      <td>70</td>
      <td>31</td>
      <td>0</td>
      <td>30.4</td>
      <td>0.315</td>
      <td>23</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>615 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## we can see that the test and train summation size matches the whole dataframe</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="c1">## does it maches the whole dataset size? (condition variable)</span>
    <span class="n">condition</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">training_folds</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_folds</span><span class="p">[</span><span class="n">k</span><span class="p">])))</span> 
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fold K=</span><span class="si">{</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">, the summation matches the whole set, </span><span class="si">{</span><span class="n">condition</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fold K=1, the summation matches the whole set, True
Fold K=2, the summation matches the whole set, True
Fold K=3, the summation matches the whole set, True
Fold K=4, the summation matches the whole set, True
Fold K=5, the summation matches the whole set, True
</pre></div>
</div>
</div>
</div>
</section>
<section id="b-bootstraping">
<h3>(b) Bootstraping<a class="headerlink" href="#b-bootstraping" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bootstrap1</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Demonstrate one iteration of bootstraping method (it is a with replacement method)</span>

<span class="sd">    INPUT:</span>
<span class="sd">    -------</span>
<span class="sd">    data: a pandas dataframe, containing our data</span>

<span class="sd">    OUPUTS:</span>
<span class="sd">    --------</span>
<span class="sd">    train_data: pandas dataframe of a sample data</span>
<span class="sd">    test_data: pandas dataframe of sample data, the data that are not included in train_data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## find the length of our data (how many data rows we have)</span>
    <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    
    <span class="c1">## the indexes to be chosen from original data </span>
    <span class="n">indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">data_length</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">data_length</span><span class="p">)</span>
    
    <span class="c1">## create the training set</span>
    <span class="n">train_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1">## choose the test set, (The data that is omited from training set)</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data</span><span class="p">,</span><span class="n">train_data</span><span class="p">,</span> <span class="n">train_data</span><span class="p">])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bootstrap_train</span><span class="p">,</span> <span class="n">bootstrap_test</span> <span class="o">=</span> <span class="n">bootstrap1</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## check the training set length with original data</span>
<span class="nb">len</span><span class="p">(</span><span class="n">bootstrap_train</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bootstrap_train</span><span class="p">))</span>
<span class="n">bootstrap_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>768
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>mass</th>
      <th>pedi</th>
      <th>age</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>455</th>
      <td>14</td>
      <td>175</td>
      <td>62</td>
      <td>30</td>
      <td>0</td>
      <td>33.6</td>
      <td>0.212</td>
      <td>38</td>
      <td>1</td>
    </tr>
    <tr>
      <th>67</th>
      <td>2</td>
      <td>109</td>
      <td>92</td>
      <td>0</td>
      <td>0</td>
      <td>42.7</td>
      <td>0.845</td>
      <td>54</td>
      <td>0</td>
    </tr>
    <tr>
      <th>692</th>
      <td>2</td>
      <td>121</td>
      <td>70</td>
      <td>32</td>
      <td>95</td>
      <td>39.1</td>
      <td>0.886</td>
      <td>23</td>
      <td>0</td>
    </tr>
    <tr>
      <th>191</th>
      <td>9</td>
      <td>123</td>
      <td>70</td>
      <td>44</td>
      <td>94</td>
      <td>33.1</td>
      <td>0.374</td>
      <td>40</td>
      <td>0</td>
    </tr>
    <tr>
      <th>711</th>
      <td>5</td>
      <td>126</td>
      <td>78</td>
      <td>27</td>
      <td>22</td>
      <td>29.6</td>
      <td>0.439</td>
      <td>40</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bootstrap_test</span><span class="p">))</span>
<span class="n">bootstrap_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>277
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>mass</th>
      <th>pedi</th>
      <th>age</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>85</td>
      <td>66</td>
      <td>29</td>
      <td>0</td>
      <td>26.6</td>
      <td>0.351</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>89</td>
      <td>66</td>
      <td>23</td>
      <td>94</td>
      <td>28.1</td>
      <td>0.167</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2</td>
      <td>197</td>
      <td>70</td>
      <td>45</td>
      <td>543</td>
      <td>30.5</td>
      <td>0.158</td>
      <td>53</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>10</td>
      <td>139</td>
      <td>80</td>
      <td>0</td>
      <td>0</td>
      <td>27.1</td>
      <td>1.441</td>
      <td>57</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0</td>
      <td>118</td>
      <td>84</td>
      <td>47</td>
      <td>230</td>
      <td>45.8</td>
      <td>0.551</td>
      <td>31</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="q7">
<h2>Q7<a class="headerlink" href="#q7" title="Permalink to this headline">#</a></h2>
<section id="id4">
<h3>(f)<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">poisson_distribution</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">lambda1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    poisson distribution function</span>

<span class="sd">    INPUT:</span>
<span class="sd">    --------</span>
<span class="sd">    X: integer or an array of integers, the input value</span>
<span class="sd">    lambda1: float, hyperparameter to set </span>

<span class="sd">    OUTPUT:</span>
<span class="sd">    ---------</span>
<span class="sd">    probabiltiy: type is same as input, the probability distribution of X</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## calculate the value above the division and below separately</span>
    <span class="n">above_division</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span> <span class="n">lambda1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">lambda1</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
    <span class="n">under_division</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">above_division</span><span class="p">,</span> <span class="n">under_division</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## parameter lambda = 2</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="n">poisson_distribution</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">lambda1</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_56_0.png" src="../_images/main_56_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## parameter lambda = 6</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="n">poisson_distribution</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">lambda1</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_57_0.png" src="../_images/main_57_0.png" />
</div>
</div>
</section>
<section id="g">
<h3>(g)<a class="headerlink" href="#g" title="Permalink to this headline">#</a></h3>
<p>The Maximum Likelihood estimation for poisson distribution is as below (Calculated in Q7 part c)
\begin{equation}
\lambda = \frac{1}{n} \sum_{i=0}^{n} x_i
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Read the data from poisson.txt file</span>
<span class="n">X_poisson</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="s1">&#39;hw1_data/poisson.txt&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">## Maximum Likelihood estimation</span>
<span class="n">lambda1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X_poisson</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_poisson</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum Likelihood Estimated Parameter for poisson.txt: &#39;</span><span class="p">,</span> <span class="n">lambda1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum Likelihood Estimated Parameter for poisson.txt:  5.24
</pre></div>
</div>
</div>
</div>
</section>
<section id="h">
<h3>(h)<a class="headerlink" href="#h" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">gamma_model</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">gamma_model</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;a = 1, b = 2&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_63_0.png" src="../_images/main_63_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">gamma_model</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">gamma_model</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;a = 3, b = 5&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_64_0.png" src="../_images/main_64_0.png" />
</div>
</div>
</section>
<section id="i">
<h3>(i)<a class="headerlink" href="#i" title="Permalink to this headline">#</a></h3>
<p>Posterior density can be found as
\begin{equation}
Posterior = Likelihood \times Prior
\end{equation}
The prior of probability is
\begin{equation}
P(x) = \frac{e^{-\lambda} \lambda^x}{x!}
\end{equation}
\begin{equation}
p(\lambda | a,b) = \frac{1}{b^a \Gamma(a)} \lambda^{a-1} e^{-\frac{\lambda}{b}}
\end{equation}
And assuming the poisson.txt file we found the proper value for lambda</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">posterior_poisson</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span> <span class="n">lambda1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    posterior for poisson distribution</span>

<span class="sd">    INPUTS:</span>
<span class="sd">    -------</span>
<span class="sd">    X: values to calculate the posterior</span>
<span class="sd">    a,b: parameters for gamma distribution</span>

<span class="sd">    OUTPUT:</span>
<span class="sd">    --------</span>
<span class="sd">    probability: floating number or an array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## we divided the function in 3 parts then multiplied it</span>
    <span class="n">gamma_distro</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">gamma_distro</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">**</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">values</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">p1</span>

    <span class="n">p2</span> <span class="o">=</span> <span class="n">lambda1</span> <span class="o">**</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">p3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">lambda1</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span>

    <span class="n">probability</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="n">p2</span> <span class="o">*</span> <span class="n">p3</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">probability</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">probability</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">posterior_poisson</span><span class="p">(</span><span class="n">X_poisson</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">lambda1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_poisson</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Posterior distribution with a=1, b=2&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25
</pre></div>
</div>
<img alt="../_images/main_67_1.png" src="../_images/main_67_1.png" />
</div>
</div>
<p>It can be seen from the plot that the posterior is not a function and it have multiple values of x for each y in range of 4 to 8.</p>
</section>
</section>
<section id="q8">
<h2>Q8<a class="headerlink" href="#q8" title="Permalink to this headline">#</a></h2>
<section id="part-1">
<h3>Part 1<a class="headerlink" href="#part-1" title="Permalink to this headline">#</a></h3>
<section id="id5">
<h4>(a)<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## read the data from housing.txt</span>
<span class="c1">## there is one or more space for each data</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CRIM&#39;</span><span class="p">,</span> <span class="s1">&#39;ZN&#39;</span><span class="p">,</span> <span class="s1">&#39;INDUS&#39;</span><span class="p">,</span> <span class="s1">&#39;CHAS&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">,</span> <span class="s1">&#39;RM&#39;</span><span class="p">,</span> <span class="s1">&#39;AGE&#39;</span><span class="p">,</span> <span class="s1">&#39;DIS&#39;</span><span class="p">,</span> <span class="s1">&#39;RAD&#39;</span><span class="p">,</span><span class="s1">&#39;TAX&#39;</span><span class="p">,</span> <span class="s1">&#39;PTRATIO&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTAT&#39;</span><span class="p">,</span> <span class="s1">&#39;MEDV&#39;</span><span class="p">]</span>
<span class="n">df_boston</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hw1_data/housing/housing.txt&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span> <span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/amin/.local/lib/python3.8/site-packages/pandas/util/_decorators.py:311: ParserWarning: Falling back to the &#39;python&#39; engine because the &#39;c&#39; engine does not support regex separators (separators &gt; 1 char and different from &#39;\s+&#39; are interpreted as regex); you can avoid this warning by specifying engine=&#39;python&#39;.
  return func(*args, **kwargs)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_boston</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
      <th>MEDV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1</td>
      <td>296.0</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
      <td>21.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
      <td>34.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
      <td>33.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
      <td>36.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_boston</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRIM       float64
ZN         float64
INDUS      float64
CHAS         int64
NOX        float64
RM         float64
AGE        float64
DIS        float64
RAD          int64
TAX        float64
PTRATIO    float64
B          float64
LSTAT      float64
MEDV       float64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>As we can see there is no attribute type as object, so we will look at the dataset closely. <br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_boston</span><span class="o">.</span><span class="n">CHAS</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    471
1     35
Name: CHAS, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>It is clear here that CHAS is a binary feature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_boston</span><span class="o">.</span><span class="n">ZN</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0      372
20.0      21
80.0      15
22.0      10
12.5      10
25.0      10
40.0       7
45.0       6
30.0       6
90.0       5
95.0       4
60.0       4
21.0       4
33.0       4
55.0       3
70.0       3
34.0       3
52.5       3
35.0       3
28.0       3
75.0       3
82.5       2
85.0       2
17.5       1
100.0      1
18.0       1
Name: ZN, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>So after having a look at dataset and two of the features we saw that just one of the columns have binary value, and it is the CHAS.</p>
</section>
<section id="id6">
<h4>(b)<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlation</span> <span class="o">=</span> <span class="n">df_boston</span><span class="p">[</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">corrwith</span><span class="p">(</span><span class="n">df_boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">correlation</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;correlation with MEDV&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>correlation with MEDV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>LSTAT</th>
      <td>-0.737663</td>
    </tr>
    <tr>
      <th>PTRATIO</th>
      <td>-0.507787</td>
    </tr>
    <tr>
      <th>INDUS</th>
      <td>-0.483725</td>
    </tr>
    <tr>
      <th>TAX</th>
      <td>-0.468536</td>
    </tr>
    <tr>
      <th>NOX</th>
      <td>-0.427321</td>
    </tr>
    <tr>
      <th>CRIM</th>
      <td>-0.388305</td>
    </tr>
    <tr>
      <th>RAD</th>
      <td>-0.381626</td>
    </tr>
    <tr>
      <th>AGE</th>
      <td>-0.376955</td>
    </tr>
    <tr>
      <th>CHAS</th>
      <td>0.175260</td>
    </tr>
    <tr>
      <th>DIS</th>
      <td>0.249929</td>
    </tr>
    <tr>
      <th>B</th>
      <td>0.333461</td>
    </tr>
    <tr>
      <th>ZN</th>
      <td>0.360445</td>
    </tr>
    <tr>
      <th>RM</th>
      <td>0.695360</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>It is clear from above that: <br>
Highest Positive Correlation: RM <br>
Highest Negative Correlation: LSTAT</p>
</section>
<section id="id7">
<h4>(c)<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">LSTAT</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">PTRATIO</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">INDUS</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">TAX</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">NOX</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">CRIM</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">AGE</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">CHAS</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">DIS</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">ZN</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">RM</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_84_0.png" src="../_images/main_84_0.png" />
</div>
</div>
<p>The most correlated features are having the most linear scatter plot. As we can see from the scatter plots, RM and LSTAT are in the most linear form.</p>
</section>
<section id="id8">
<h4>(d)<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_boston</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
      <th>MEDV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CRIM</th>
      <td>1.000000</td>
      <td>-0.200469</td>
      <td>0.406583</td>
      <td>-0.055892</td>
      <td>0.420972</td>
      <td>-0.219247</td>
      <td>0.352734</td>
      <td>-0.379670</td>
      <td>0.625505</td>
      <td>0.582764</td>
      <td>0.289946</td>
      <td>-0.385064</td>
      <td>0.455621</td>
      <td>-0.388305</td>
    </tr>
    <tr>
      <th>ZN</th>
      <td>-0.200469</td>
      <td>1.000000</td>
      <td>-0.533828</td>
      <td>-0.042697</td>
      <td>-0.516604</td>
      <td>0.311991</td>
      <td>-0.569537</td>
      <td>0.664408</td>
      <td>-0.311948</td>
      <td>-0.314563</td>
      <td>-0.391679</td>
      <td>0.175520</td>
      <td>-0.412995</td>
      <td>0.360445</td>
    </tr>
    <tr>
      <th>INDUS</th>
      <td>0.406583</td>
      <td>-0.533828</td>
      <td>1.000000</td>
      <td>0.062938</td>
      <td>0.763651</td>
      <td>-0.391676</td>
      <td>0.644779</td>
      <td>-0.708027</td>
      <td>0.595129</td>
      <td>0.720760</td>
      <td>0.383248</td>
      <td>-0.356977</td>
      <td>0.603800</td>
      <td>-0.483725</td>
    </tr>
    <tr>
      <th>CHAS</th>
      <td>-0.055892</td>
      <td>-0.042697</td>
      <td>0.062938</td>
      <td>1.000000</td>
      <td>0.091203</td>
      <td>0.091251</td>
      <td>0.086518</td>
      <td>-0.099176</td>
      <td>-0.007368</td>
      <td>-0.035587</td>
      <td>-0.121515</td>
      <td>0.048788</td>
      <td>-0.053929</td>
      <td>0.175260</td>
    </tr>
    <tr>
      <th>NOX</th>
      <td>0.420972</td>
      <td>-0.516604</td>
      <td>0.763651</td>
      <td>0.091203</td>
      <td>1.000000</td>
      <td>-0.302188</td>
      <td>0.731470</td>
      <td>-0.769230</td>
      <td>0.611441</td>
      <td>0.668023</td>
      <td>0.188933</td>
      <td>-0.380051</td>
      <td>0.590879</td>
      <td>-0.427321</td>
    </tr>
    <tr>
      <th>RM</th>
      <td>-0.219247</td>
      <td>0.311991</td>
      <td>-0.391676</td>
      <td>0.091251</td>
      <td>-0.302188</td>
      <td>1.000000</td>
      <td>-0.240265</td>
      <td>0.205246</td>
      <td>-0.209847</td>
      <td>-0.292048</td>
      <td>-0.355501</td>
      <td>0.128069</td>
      <td>-0.613808</td>
      <td>0.695360</td>
    </tr>
    <tr>
      <th>AGE</th>
      <td>0.352734</td>
      <td>-0.569537</td>
      <td>0.644779</td>
      <td>0.086518</td>
      <td>0.731470</td>
      <td>-0.240265</td>
      <td>1.000000</td>
      <td>-0.747881</td>
      <td>0.456022</td>
      <td>0.506456</td>
      <td>0.261515</td>
      <td>-0.273534</td>
      <td>0.602339</td>
      <td>-0.376955</td>
    </tr>
    <tr>
      <th>DIS</th>
      <td>-0.379670</td>
      <td>0.664408</td>
      <td>-0.708027</td>
      <td>-0.099176</td>
      <td>-0.769230</td>
      <td>0.205246</td>
      <td>-0.747881</td>
      <td>1.000000</td>
      <td>-0.494588</td>
      <td>-0.534432</td>
      <td>-0.232471</td>
      <td>0.291512</td>
      <td>-0.496996</td>
      <td>0.249929</td>
    </tr>
    <tr>
      <th>RAD</th>
      <td>0.625505</td>
      <td>-0.311948</td>
      <td>0.595129</td>
      <td>-0.007368</td>
      <td>0.611441</td>
      <td>-0.209847</td>
      <td>0.456022</td>
      <td>-0.494588</td>
      <td>1.000000</td>
      <td>0.910228</td>
      <td>0.464741</td>
      <td>-0.444413</td>
      <td>0.488676</td>
      <td>-0.381626</td>
    </tr>
    <tr>
      <th>TAX</th>
      <td>0.582764</td>
      <td>-0.314563</td>
      <td>0.720760</td>
      <td>-0.035587</td>
      <td>0.668023</td>
      <td>-0.292048</td>
      <td>0.506456</td>
      <td>-0.534432</td>
      <td>0.910228</td>
      <td>1.000000</td>
      <td>0.460853</td>
      <td>-0.441808</td>
      <td>0.543993</td>
      <td>-0.468536</td>
    </tr>
    <tr>
      <th>PTRATIO</th>
      <td>0.289946</td>
      <td>-0.391679</td>
      <td>0.383248</td>
      <td>-0.121515</td>
      <td>0.188933</td>
      <td>-0.355501</td>
      <td>0.261515</td>
      <td>-0.232471</td>
      <td>0.464741</td>
      <td>0.460853</td>
      <td>1.000000</td>
      <td>-0.177383</td>
      <td>0.374044</td>
      <td>-0.507787</td>
    </tr>
    <tr>
      <th>B</th>
      <td>-0.385064</td>
      <td>0.175520</td>
      <td>-0.356977</td>
      <td>0.048788</td>
      <td>-0.380051</td>
      <td>0.128069</td>
      <td>-0.273534</td>
      <td>0.291512</td>
      <td>-0.444413</td>
      <td>-0.441808</td>
      <td>-0.177383</td>
      <td>1.000000</td>
      <td>-0.366087</td>
      <td>0.333461</td>
    </tr>
    <tr>
      <th>LSTAT</th>
      <td>0.455621</td>
      <td>-0.412995</td>
      <td>0.603800</td>
      <td>-0.053929</td>
      <td>0.590879</td>
      <td>-0.613808</td>
      <td>0.602339</td>
      <td>-0.496996</td>
      <td>0.488676</td>
      <td>0.543993</td>
      <td>0.374044</td>
      <td>-0.366087</td>
      <td>1.000000</td>
      <td>-0.737663</td>
    </tr>
    <tr>
      <th>MEDV</th>
      <td>-0.388305</td>
      <td>0.360445</td>
      <td>-0.483725</td>
      <td>0.175260</td>
      <td>-0.427321</td>
      <td>0.695360</td>
      <td>-0.376955</td>
      <td>0.249929</td>
      <td>-0.381626</td>
      <td>-0.468536</td>
      <td>-0.507787</td>
      <td>0.333461</td>
      <td>-0.737663</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The most correlated ones are <strong>TAX</strong> and <strong>RAD</strong> with the correlation value of 0.910228.</p>
</section>
</section>
<section id="part-2">
<h3>Part 2<a class="headerlink" href="#part-2" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">df_housing_read</span><span class="p">(</span><span class="n">test</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CRIM&#39;</span><span class="p">,</span> <span class="s1">&#39;ZN&#39;</span><span class="p">,</span> <span class="s1">&#39;INDUS&#39;</span><span class="p">,</span> <span class="s1">&#39;CHAS&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">,</span> <span class="s1">&#39;RM&#39;</span><span class="p">,</span> <span class="s1">&#39;AGE&#39;</span><span class="p">,</span> <span class="s1">&#39;DIS&#39;</span><span class="p">,</span> <span class="s1">&#39;RAD&#39;</span><span class="p">,</span><span class="s1">&#39;TAX&#39;</span><span class="p">,</span> <span class="s1">&#39;PTRATIO&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTAT&#39;</span><span class="p">,</span> <span class="s1">&#39;MEDV&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">test</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hw1_data/housing/housing_test.txt&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hw1_data/housing/housing_train.txt&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<section id="id9">
<h4>(a)<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span> <span class="o">=</span> <span class="n">df_housing_read</span><span class="p">()</span>
<span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
      <th>MEDV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1</td>
      <td>296.0</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
      <td>21.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
      <td>34.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
      <td>33.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
      <td>36.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Target output is <em>MEDV</em>, and we can split it from the train dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Get feature vectors and target output</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">MEDV</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;MEDV&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Linear regression weights can be found as
\begin{equation}
w = A^{-1} b
\end{equation}
where b and A can be found as
\begin{equation}
A = \sum_{i=0}^{n} x_i x_i^{T}
\end{equation}
\begin{equation}
b = \sum_{i=0}^{n} y_i x_i
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">LR_solve</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Linear regression solve function</span>
<span class="sd">    Using the old equation w = invers(A) * b</span>

<span class="sd">    Parameters:</span>
<span class="sd">    --------</span>
<span class="sd">    X : matrix_like</span>
<span class="sd">        The feature vectors matrix</span>
<span class="sd">    Y : array_like</span>
<span class="sd">        The vector of each feature vector labels (target outputs)</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    w : array_like</span>
<span class="sd">        The vector of weights fitted on `X` features</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="c1">## create b and preprocess it</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">w</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## giving the transpose of X, because it&#39;s as row in our dataset</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">LR_solve</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Weights: </span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Shape:</span><span class="si">{</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weights: [-9.79342380e-02  4.89586765e-02 -2.53928478e-02  3.45087927e+00
 -3.55458931e-01  5.81653272e+00 -3.31447963e-03 -1.02050134e+00
  2.26563208e-01 -1.22458785e-02 -3.88029879e-01  1.70214971e-02
 -4.85012955e-01] 
Shape:(13,)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id10">
<h4>(b)<a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">LR_predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Predict the Linear Regression using fixed input weights</span>

<span class="sd">    Paramaters:</span>
<span class="sd">    -----------</span>
<span class="sd">    X_test : matrix_like </span>
<span class="sd">        test data, an array of feature vectors</span>
<span class="sd">    w : array_like</span>
<span class="sd">        array of weights, shape must meet `(n, 1)`, column vector</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    Y_pred : array_like </span>
<span class="sd">        the prediction of test data, using weights</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Y_pred</span> <span class="o">=</span> <span class="n">X_test</span> <span class="o">@</span> <span class="n">w</span>

    <span class="k">return</span> <span class="n">Y_pred</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CRIM&#39;</span><span class="p">,</span> <span class="s1">&#39;ZN&#39;</span><span class="p">,</span> <span class="s1">&#39;INDUS&#39;</span><span class="p">,</span> <span class="s1">&#39;CHAS&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">,</span> <span class="s1">&#39;RM&#39;</span><span class="p">,</span> <span class="s1">&#39;AGE&#39;</span><span class="p">,</span> <span class="s1">&#39;DIS&#39;</span><span class="p">,</span> <span class="s1">&#39;RAD&#39;</span><span class="p">,</span><span class="s1">&#39;TAX&#39;</span><span class="p">,</span> <span class="s1">&#39;PTRATIO&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTAT&#39;</span><span class="p">,</span> <span class="s1">&#39;MEDV&#39;</span><span class="p">]</span>
<span class="n">df_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hw1_data/housing/housing_test.txt&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="n">df_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
      <th>MEDV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.84054</td>
      <td>0.0</td>
      <td>8.14</td>
      <td>0</td>
      <td>0.538</td>
      <td>5.599</td>
      <td>85.7</td>
      <td>4.4546</td>
      <td>4</td>
      <td>307.0</td>
      <td>21.0</td>
      <td>303.42</td>
      <td>16.51</td>
      <td>13.9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.67191</td>
      <td>0.0</td>
      <td>8.14</td>
      <td>0</td>
      <td>0.538</td>
      <td>5.813</td>
      <td>90.3</td>
      <td>4.6820</td>
      <td>4</td>
      <td>307.0</td>
      <td>21.0</td>
      <td>376.88</td>
      <td>14.81</td>
      <td>16.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.95577</td>
      <td>0.0</td>
      <td>8.14</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.047</td>
      <td>88.8</td>
      <td>4.4534</td>
      <td>4</td>
      <td>307.0</td>
      <td>21.0</td>
      <td>306.38</td>
      <td>17.28</td>
      <td>14.8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.77299</td>
      <td>0.0</td>
      <td>8.14</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.495</td>
      <td>94.4</td>
      <td>4.4547</td>
      <td>4</td>
      <td>307.0</td>
      <td>21.0</td>
      <td>387.94</td>
      <td>12.80</td>
      <td>18.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.00245</td>
      <td>0.0</td>
      <td>8.14</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.674</td>
      <td>87.3</td>
      <td>4.2390</td>
      <td>4</td>
      <td>307.0</td>
      <td>21.0</td>
      <td>380.23</td>
      <td>11.98</td>
      <td>21.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test</span> <span class="o">=</span> <span class="n">df_test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MEDV&#39;</span><span class="p">])</span>
<span class="n">Y_test_actual</span> <span class="o">=</span> <span class="n">df_test</span><span class="o">.</span><span class="n">MEDV</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y_test_pred</span> <span class="o">=</span> <span class="n">LR_predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="n">Y_test_pred</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    13.411778
1    16.500643
2    15.674173
3    21.839123
4    23.367941
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="c-d">
<h4>(c, d)<a class="headerlink" href="#c-d" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## the main3_2.py program</span>
<span class="o">!</span>python3 scripts/main3_2.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Regression on housing dataset program!
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
      CRIM    ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.00632  18.0   2.31     0  0.538  ...    1  296.0     15.3  396.90   4.98
1  0.02731   0.0   7.07     0  0.469  ...    2  242.0     17.8  396.90   9.14
2  0.02729   0.0   7.07     0  0.469  ...    2  242.0     17.8  392.83   4.03
3  0.03237   0.0   2.18     0  0.458  ...    3  222.0     18.7  394.63   2.94
4  0.06905   0.0   2.18     0  0.458  ...    3  222.0     18.7  396.90   5.33

[5 rows x 13 columns]
Test set head :
      CRIM   ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.84054  0.0   8.14     0  0.538  ...    4  307.0     21.0  303.42  16.51
1  0.67191  0.0   8.14     0  0.538  ...    4  307.0     21.0  376.88  14.81
2  0.95577  0.0   8.14     0  0.538  ...    4  307.0     21.0  306.38  17.28
3  0.77299  0.0   8.14     0  0.538  ...    4  307.0     21.0  387.94  12.80
4  1.00245  0.0   8.14     0  0.538  ...    4  307.0     21.0  380.23  11.98

[5 rows x 13 columns]
----------------------------------------------------------------------
Training: 
Mean Squared Error: 24.475882784643673
Testing: 
Mean Squared Error: 24.29223817565946
----------------------------------------------------------------------
Weights of the training
[-9.79342380e-02  4.89586765e-02 -2.53928478e-02  3.45087927e+00
 -3.55458931e-01  5.81653272e+00 -3.31447963e-03 -1.02050134e+00
  2.26563208e-01 -1.22458785e-02 -3.88029879e-01  1.70214971e-02
 -4.85012955e-01]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="part-3">
<h3>Part 3<a class="headerlink" href="#part-3" title="Permalink to this headline">#</a></h3>
<section id="a-online-linear-regression">
<h4>(a) Online Linear Regression<a class="headerlink" href="#a-online-linear-regression" title="Permalink to this headline">#</a></h4>
<p>The equation for online linear regression is
\begin{equation}
W_i = W_{i-1} + \alpha_i (y_i - f(x_i, W_{i-1})) x_i
\end{equation}
Where <span class="math notranslate nohighlight">\(\alpha\)</span> is the learning rate, <span class="math notranslate nohighlight">\(W_i\)</span> is the weights rate fot the <span class="math notranslate nohighlight">\(i\)</span>-th iteration and <span class="math notranslate nohighlight">\(x_i\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>-th feature vector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span> <span class="o">=</span> <span class="n">df_housing_read</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    normalize a pandas dataframe</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    df : pandas dataframe</span>
<span class="sd">        the dataset that is going to be normalized</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pandas dataframe</span>
<span class="sd">        the normalized dataframe</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df_normalized</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="o">.</span><span class="n">columns</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
        <span class="n">df_normalized</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_normalized</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_normalized</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="p">)</span> <span class="o">/</span> <span class="n">df_normalized</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">df_normalized</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_normal</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span>
<span class="n">df_train_normal</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
      <th>MEDV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.406074</td>
      <td>0.271666</td>
      <td>-1.269381</td>
      <td>-0.267612</td>
      <td>-0.128607</td>
      <td>0.384651</td>
      <td>-0.095048</td>
      <td>0.140689</td>
      <td>-0.969579</td>
      <td>-0.612355</td>
      <td>-1.449420</td>
      <td>0.409077</td>
      <td>-1.046568</td>
      <td>0.119273</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.403616</td>
      <td>-0.486839</td>
      <td>-0.554501</td>
      <td>-0.267612</td>
      <td>-0.726487</td>
      <td>0.168444</td>
      <td>0.397814</td>
      <td>0.567315</td>
      <td>-0.854463</td>
      <td>-0.934791</td>
      <td>-0.274757</td>
      <td>0.409077</td>
      <td>-0.459782</td>
      <td>-0.133425</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.403618</td>
      <td>-0.486839</td>
      <td>-0.554501</td>
      <td>-0.267612</td>
      <td>-0.726487</td>
      <td>1.241055</td>
      <td>-0.242547</td>
      <td>0.567315</td>
      <td>-0.854463</td>
      <td>-0.934791</td>
      <td>-0.274757</td>
      <td>0.360950</td>
      <td>-1.180570</td>
      <td>1.245885</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.403023</td>
      <td>-0.486839</td>
      <td>-1.288905</td>
      <td>-0.267612</td>
      <td>-0.821802</td>
      <td>0.978518</td>
      <td>-0.792968</td>
      <td>1.099976</td>
      <td>-0.739347</td>
      <td>-1.054212</td>
      <td>0.148121</td>
      <td>0.382235</td>
      <td>-1.334319</td>
      <td>1.109007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.398727</td>
      <td>-0.486839</td>
      <td>-1.288905</td>
      <td>-0.267612</td>
      <td>-0.821802</td>
      <td>1.187706</td>
      <td>-0.490776</td>
      <td>1.099976</td>
      <td>-0.739347</td>
      <td>-1.054212</td>
      <td>0.148121</td>
      <td>0.409077</td>
      <td>-0.997199</td>
      <td>1.403821</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">LR_Incremental_solve</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="nb">iter</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Incremental Learning for Linear Regression</span>
<span class="sd">    The method used is online gradient descent</span>
<span class="sd">    the learning rate is 2/t, and t stands for iteration number</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    X : matrix_like</span>
<span class="sd">        the features vectors for training </span>
<span class="sd">    Y : array_like</span>
<span class="sd">        the target output for each feature vectors represented in `X`</span>
<span class="sd">    W : array_like</span>
<span class="sd">        the initial weights for online gradient descent</span>
<span class="sd">    iter : integer</span>
<span class="sd">        the number of iterations to learn</span>

<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    W : array_like</span>
<span class="sd">        the learned weights for linear regression </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">iter</span><span class="p">):</span>
        <span class="c1">## data index is different from the index</span>
        <span class="c1">## so we calculate it everytime</span>
        <span class="n">data_index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

        <span class="c1">## the update term that is added to old weight</span>
        <span class="n">update_term</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">data_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">Function</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">data_index</span><span class="p">],</span> <span class="n">W</span><span class="p">)</span>

        <span class="c1">## the learning rate</span>
        <span class="n">learning_rate</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> 
        <span class="n">update_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">update_term</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">data_index</span><span class="p">])</span>

        <span class="c1">## update the weights</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">update_term</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">W</span>

<span class="k">def</span> <span class="nf">Function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The function for calculating the predicted output for `X`</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        the features vector  </span>
<span class="sd">    W : array_like</span>
<span class="sd">        the learned weights</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    Y_pred : float</span>
<span class="sd">        The predicted value for the input weights and the feature vector</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">Y_pred</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## initialize the data</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">df_train_normal</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MEDV&#39;</span><span class="p">])</span>
<span class="n">Y_train</span> <span class="o">=</span> <span class="n">df_train_normal</span><span class="o">.</span><span class="n">MEDV</span>

<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="n">LR_Incremental_solve</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span> <span class="n">Y_train</span><span class="p">,</span><span class="n">W</span><span class="o">=</span> <span class="n">W</span><span class="p">)</span>
<span class="n">weights</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRIM      -0.020193
ZN         0.620314
INDUS      0.289735
CHAS      -0.076357
NOX        3.653932
RM         0.948070
AGE       -1.926829
DIS        1.026664
RAD       -2.659829
TAX        0.703401
PTRATIO    1.108539
B          1.023090
LSTAT     -0.511682
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="id11">
<h4>(b)<a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main3_3.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Regression on housing dataset program!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
      CRIM    ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.00632  18.0   2.31     0  0.538  ...    1  296.0     15.3  396.90   4.98
1  0.02731   0.0   7.07     0  0.469  ...    2  242.0     17.8  396.90   9.14
2  0.02729   0.0   7.07     0  0.469  ...    2  242.0     17.8  392.83   4.03
3  0.03237   0.0   2.18     0  0.458  ...    3  222.0     18.7  394.63   2.94
4  0.06905   0.0   2.18     0  0.458  ...    3  222.0     18.7  396.90   5.33

[5 rows x 13 columns]
Test set head :
      CRIM   ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.84054  0.0   8.14     0  0.538  ...    4  307.0     21.0  303.42  16.51
1  0.67191  0.0   8.14     0  0.538  ...    4  307.0     21.0  376.88  14.81
2  0.95577  0.0   8.14     0  0.538  ...    4  307.0     21.0  306.38  17.28
3  0.77299  0.0   8.14     0  0.538  ...    4  307.0     21.0  387.94  12.80
4  1.00245  0.0   8.14     0  0.538  ...    4  307.0     21.0  380.23  11.98

[5 rows x 13 columns]
----------------------------------------------------------------------
----------------------------------------------------------------------
Training: 
Mean Squared Error: 24.475882784643673
Testing using the last trained weights: 
Test
Mean Squared Error: 24.29223817565946
----------------------------------------------------------------------
Weights of the training
[-9.79342380e-02  4.89586765e-02 -2.53928478e-02  3.45087927e+00
 -3.55458931e-01  5.81653272e+00 -3.31447963e-03 -1.02050134e+00
  2.26563208e-01 -1.22458785e-02 -3.88029879e-01  1.70214971e-02
 -4.85012955e-01]
----------------------------------------------------------------------
----------------------------------------------------------------------
Incremental Learning
Training
Mean Squared Error: 6.794950630755434
Test
Mean Squared Error: 269174.89239789307
----------------------------------------------------------------------
Final wights of Incremental Learning
[-9.79342380e-02  4.89586765e-02 -2.53928478e-02  3.45087927e+00
 -3.55458931e-01  5.81653272e+00 -3.31447963e-03 -1.02050134e+00
  2.26563208e-01 -1.22458785e-02 -3.88029879e-01  1.70214971e-02
 -4.85012955e-01]
----------------------------------------------------------------------
Partial Wights
Plotting Training and Test Loss
Figure(1500x500)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id12">
<h4>(c)<a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h4>
<p>Using unnormalized dataset, will overflow and the program would stop.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## we&#39;re using unnormalized dataset</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MEDV&#39;</span><span class="p">])</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">MEDV</span>

<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>

<span class="n">weights</span> <span class="o">=</span> <span class="n">LR_Incremental_solve</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span> <span class="n">Y</span><span class="p">,</span><span class="n">W</span><span class="o">=</span> <span class="n">W</span><span class="p">)</span>
<span class="n">weights</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRIM      NaN
ZN        NaN
INDUS     NaN
CHAS      NaN
NOX       NaN
RM        NaN
AGE       NaN
DIS       NaN
RAD       NaN
TAX       NaN
PTRATIO   NaN
B         NaN
LSTAT     NaN
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Getting NaN shows that overflow has happened.</p>
</section>
<section id="id13">
<h4>(d)<a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main3_3.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Regression on housing dataset program!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
      CRIM    ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.00632  18.0   2.31     0  0.538  ...    1  296.0     15.3  396.90   4.98
1  0.02731   0.0   7.07     0  0.469  ...    2  242.0     17.8  396.90   9.14
2  0.02729   0.0   7.07     0  0.469  ...    2  242.0     17.8  392.83   4.03
3  0.03237   0.0   2.18     0  0.458  ...    3  222.0     18.7  394.63   2.94
4  0.06905   0.0   2.18     0  0.458  ...    3  222.0     18.7  396.90   5.33

[5 rows x 13 columns]
Test set head :
      CRIM   ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.84054  0.0   8.14     0  0.538  ...    4  307.0     21.0  303.42  16.51
1  0.67191  0.0   8.14     0  0.538  ...    4  307.0     21.0  376.88  14.81
2  0.95577  0.0   8.14     0  0.538  ...    4  307.0     21.0  306.38  17.28
3  0.77299  0.0   8.14     0  0.538  ...    4  307.0     21.0  387.94  12.80
4  1.00245  0.0   8.14     0  0.538  ...    4  307.0     21.0  380.23  11.98

[5 rows x 13 columns]
----------------------------------------------------------------------
----------------------------------------------------------------------
Training: 
Mean Squared Error: 24.475882784643673
Testing using the last trained weights: 
Test
Mean Squared Error: 24.29223817565946
----------------------------------------------------------------------
Weights of the training
[-9.79342380e-02  4.89586765e-02 -2.53928478e-02  3.45087927e+00
 -3.55458931e-01  5.81653272e+00 -3.31447963e-03 -1.02050134e+00
  2.26563208e-01 -1.22458785e-02 -3.88029879e-01  1.70214971e-02
 -4.85012955e-01]
----------------------------------------------------------------------
----------------------------------------------------------------------
Incremental Learning
Training
Mean Squared Error: 6.794950630755434
Test
Mean Squared Error: 269174.89239789307
----------------------------------------------------------------------
Final wights of Incremental Learning
[-9.79342380e-02  4.89586765e-02 -2.53928478e-02  3.45087927e+00
 -3.55458931e-01  5.81653272e+00 -3.31447963e-03 -1.02050134e+00
  2.26563208e-01 -1.22458785e-02 -3.88029879e-01  1.70214971e-02
 -4.85012955e-01]
----------------------------------------------------------------------
Partial Wights
Plotting Training and Test Loss
Figure(1500x500)
</pre></div>
</div>
</div>
</div>
</section>
<section id="d-2">
<h4>(d.2)<a class="headerlink" href="#d-2" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## using the learning rate 2 / sqrt(t)</span>
<span class="o">!</span>python3 scripts/main3_3.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Regression on housing dataset program!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
      CRIM    ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.00632  18.0   2.31     0  0.538  ...    1  296.0     15.3  396.90   4.98
1  0.02731   0.0   7.07     0  0.469  ...    2  242.0     17.8  396.90   9.14
2  0.02729   0.0   7.07     0  0.469  ...    2  242.0     17.8  392.83   4.03
3  0.03237   0.0   2.18     0  0.458  ...    3  222.0     18.7  394.63   2.94
4  0.06905   0.0   2.18     0  0.458  ...    3  222.0     18.7  396.90   5.33

[5 rows x 13 columns]
Test set head :
      CRIM   ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.84054  0.0   8.14     0  0.538  ...    4  307.0     21.0  303.42  16.51
1  0.67191  0.0   8.14     0  0.538  ...    4  307.0     21.0  376.88  14.81
2  0.95577  0.0   8.14     0  0.538  ...    4  307.0     21.0  306.38  17.28
3  0.77299  0.0   8.14     0  0.538  ...    4  307.0     21.0  387.94  12.80
4  1.00245  0.0   8.14     0  0.538  ...    4  307.0     21.0  380.23  11.98

[5 rows x 13 columns]
----------------------------------------------------------------------
----------------------------------------------------------------------
Training: 
Mean Squared Error: 24.475882784643673
Testing using the last trained weights: 
Test
Mean Squared Error: 24.29223817565946
----------------------------------------------------------------------
Weights of the training
[-9.79342380e-02  4.89586765e-02 -2.53928478e-02  3.45087927e+00
 -3.55458931e-01  5.81653272e+00 -3.31447963e-03 -1.02050134e+00
  2.26563208e-01 -1.22458785e-02 -3.88029879e-01  1.70214971e-02
 -4.85012955e-01]
----------------------------------------------------------------------
----------------------------------------------------------------------
Incremental Learning
Training
Mean Squared Error: 1.5252088672442436e+54
Test
Mean Squared Error: 4.577866801177761e+56
----------------------------------------------------------------------
Final wights of Incremental Learning
[-9.79342380e-02  4.89586765e-02 -2.53928478e-02  3.45087927e+00
 -3.55458931e-01  5.81653272e+00 -3.31447963e-03 -1.02050134e+00
  2.26563208e-01 -1.22458785e-02 -3.88029879e-01  1.70214971e-02
 -4.85012955e-01]
----------------------------------------------------------------------
Partial Wights
Plotting Training and Test Loss
Figure(1500x500)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## using static learning rate 0.5 </span>
<span class="o">!</span>python3 scripts/main3_3.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">0</span>.5
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Regression on housing dataset program!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
      CRIM    ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.00632  18.0   2.31     0  0.538  ...    1  296.0     15.3  396.90   4.98
1  0.02731   0.0   7.07     0  0.469  ...    2  242.0     17.8  396.90   9.14
2  0.02729   0.0   7.07     0  0.469  ...    2  242.0     17.8  392.83   4.03
3  0.03237   0.0   2.18     0  0.458  ...    3  222.0     18.7  394.63   2.94
4  0.06905   0.0   2.18     0  0.458  ...    3  222.0     18.7  396.90   5.33

[5 rows x 13 columns]
Test set head :
      CRIM   ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.84054  0.0   8.14     0  0.538  ...    4  307.0     21.0  303.42  16.51
1  0.67191  0.0   8.14     0  0.538  ...    4  307.0     21.0  376.88  14.81
2  0.95577  0.0   8.14     0  0.538  ...    4  307.0     21.0  306.38  17.28
3  0.77299  0.0   8.14     0  0.538  ...    4  307.0     21.0  387.94  12.80
4  1.00245  0.0   8.14     0  0.538  ...    4  307.0     21.0  380.23  11.98

[5 rows x 13 columns]
----------------------------------------------------------------------
----------------------------------------------------------------------
Training: 
Mean Squared Error: 24.475882784643673
Testing using the last trained weights: 
Test
Mean Squared Error: 24.29223817565946
----------------------------------------------------------------------
Weights of the training
[-9.79342380e-02  4.89586765e-02 -2.53928478e-02  3.45087927e+00
 -3.55458931e-01  5.81653272e+00 -3.31447963e-03 -1.02050134e+00
  2.26563208e-01 -1.22458785e-02 -3.88029879e-01  1.70214971e-02
 -4.85012955e-01]
----------------------------------------------------------------------
----------------------------------------------------------------------
Incremental Learning
Training
Mean Squared Error: 0.0
Test
Mean Squared Error: 0.0
----------------------------------------------------------------------
Final wights of Incremental Learning
[-9.79342380e-02  4.89586765e-02 -2.53928478e-02  3.45087927e+00
 -3.55458931e-01  5.81653272e+00 -3.31447963e-03 -1.02050134e+00
  2.26563208e-01 -1.22458785e-02 -3.88029879e-01  1.70214971e-02
 -4.85012955e-01]
----------------------------------------------------------------------
Partial Wights
Plotting Training and Test Loss
Figure(1500x500)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## using static learning rate 0.5 </span>
<span class="o">!</span>python3 scripts/main3_3.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">0</span>.01
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Regression on housing dataset program!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
      CRIM    ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.00632  18.0   2.31     0  0.538  ...    1  296.0     15.3  396.90   4.98
1  0.02731   0.0   7.07     0  0.469  ...    2  242.0     17.8  396.90   9.14
2  0.02729   0.0   7.07     0  0.469  ...    2  242.0     17.8  392.83   4.03
3  0.03237   0.0   2.18     0  0.458  ...    3  222.0     18.7  394.63   2.94
4  0.06905   0.0   2.18     0  0.458  ...    3  222.0     18.7  396.90   5.33

[5 rows x 13 columns]
Test set head :
      CRIM   ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.84054  0.0   8.14     0  0.538  ...    4  307.0     21.0  303.42  16.51
1  0.67191  0.0   8.14     0  0.538  ...    4  307.0     21.0  376.88  14.81
2  0.95577  0.0   8.14     0  0.538  ...    4  307.0     21.0  306.38  17.28
3  0.77299  0.0   8.14     0  0.538  ...    4  307.0     21.0  387.94  12.80
4  1.00245  0.0   8.14     0  0.538  ...    4  307.0     21.0  380.23  11.98

[5 rows x 13 columns]
----------------------------------------------------------------------
----------------------------------------------------------------------
Training: 
Mean Squared Error: 24.475882784643673
Testing using the last trained weights: 
Test
Mean Squared Error: 24.29223817565946
----------------------------------------------------------------------
Weights of the training
[-9.79342380e-02  4.89586765e-02 -2.53928478e-02  3.45087927e+00
 -3.55458931e-01  5.81653272e+00 -3.31447963e-03 -1.02050134e+00
  2.26563208e-01 -1.22458785e-02 -3.88029879e-01  1.70214971e-02
 -4.85012955e-01]
----------------------------------------------------------------------
----------------------------------------------------------------------
Incremental Learning
Training
Mean Squared Error: 0.29961777287140706
Test
Mean Squared Error: 1568.3310594686245
----------------------------------------------------------------------
Final wights of Incremental Learning
[-9.79342380e-02  4.89586765e-02 -2.53928478e-02  3.45087927e+00
 -3.55458931e-01  5.81653272e+00 -3.31447963e-03 -1.02050134e+00
  2.26563208e-01 -1.22458785e-02 -3.88029879e-01  1.70214971e-02
 -4.85012955e-01]
----------------------------------------------------------------------
Partial Wights
Plotting Training and Test Loss
Figure(1500x500)
</pre></div>
</div>
</div>
</div>
<p>As we saw, the losses for both training set and test set online Linear Regression (LR) with learning rate 0.5 is zero. We can conclude from this, that the online LR with learning rate 0.5 can be the most suitable model for our problem.</p>
</section>
</section>
<section id="part-4">
<h3>Part 4<a class="headerlink" href="#part-4" title="Permalink to this headline">#</a></h3>
<section id="id14">
<h4>(a)<a class="headerlink" href="#id14" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">extendx</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    extend the X dataset and return the linear and two degrees dataset</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    X : matrix_like</span>
<span class="sd">        our dataset</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    extended_X : matrix_like</span>
<span class="sd">        the dataset containing both X and X^2 data</span>
<span class="sd">        Note: extended_X length is double the X </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1">## the power 2</span>
    <span class="n">df_2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span> <span class="n">df</span> <span class="p">,</span><span class="n">df_2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>


    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_housing_read</span><span class="p">()</span>

<span class="n">extendx</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
      <th>MEDV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.006320</td>
      <td>18.0</td>
      <td>2.3100</td>
      <td>0</td>
      <td>0.538000</td>
      <td>6.575000</td>
      <td>65.20</td>
      <td>4.090000</td>
      <td>1</td>
      <td>296.0</td>
      <td>15.3</td>
      <td>396.9000</td>
      <td>4.9800</td>
      <td>24.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.027310</td>
      <td>0.0</td>
      <td>7.0700</td>
      <td>0</td>
      <td>0.469000</td>
      <td>6.421000</td>
      <td>78.90</td>
      <td>4.967100</td>
      <td>2</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>396.9000</td>
      <td>9.1400</td>
      <td>21.60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.027290</td>
      <td>0.0</td>
      <td>7.0700</td>
      <td>0</td>
      <td>0.469000</td>
      <td>7.185000</td>
      <td>61.10</td>
      <td>4.967100</td>
      <td>2</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>392.8300</td>
      <td>4.0300</td>
      <td>34.70</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.032370</td>
      <td>0.0</td>
      <td>2.1800</td>
      <td>0</td>
      <td>0.458000</td>
      <td>6.998000</td>
      <td>45.80</td>
      <td>6.062200</td>
      <td>3</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>394.6300</td>
      <td>2.9400</td>
      <td>33.40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.069050</td>
      <td>0.0</td>
      <td>2.1800</td>
      <td>0</td>
      <td>0.458000</td>
      <td>7.147000</td>
      <td>54.20</td>
      <td>6.062200</td>
      <td>3</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>396.9000</td>
      <td>5.3300</td>
      <td>36.20</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>861</th>
      <td>0.003923</td>
      <td>0.0</td>
      <td>142.3249</td>
      <td>0</td>
      <td>0.328329</td>
      <td>43.467649</td>
      <td>4774.81</td>
      <td>6.143458</td>
      <td>1</td>
      <td>74529.0</td>
      <td>441.0</td>
      <td>153656.1601</td>
      <td>93.5089</td>
      <td>501.76</td>
    </tr>
    <tr>
      <th>862</th>
      <td>0.002049</td>
      <td>0.0</td>
      <td>142.3249</td>
      <td>0</td>
      <td>0.328329</td>
      <td>37.454400</td>
      <td>5882.89</td>
      <td>5.232656</td>
      <td>1</td>
      <td>74529.0</td>
      <td>441.0</td>
      <td>157529.6100</td>
      <td>82.4464</td>
      <td>424.36</td>
    </tr>
    <tr>
      <th>863</th>
      <td>0.003692</td>
      <td>0.0</td>
      <td>142.3249</td>
      <td>0</td>
      <td>0.328329</td>
      <td>48.664576</td>
      <td>8281.00</td>
      <td>4.698056</td>
      <td>1</td>
      <td>74529.0</td>
      <td>441.0</td>
      <td>157529.6100</td>
      <td>31.8096</td>
      <td>571.21</td>
    </tr>
    <tr>
      <th>864</th>
      <td>0.012010</td>
      <td>0.0</td>
      <td>142.3249</td>
      <td>0</td>
      <td>0.328329</td>
      <td>46.158436</td>
      <td>7974.49</td>
      <td>5.706843</td>
      <td>1</td>
      <td>74529.0</td>
      <td>441.0</td>
      <td>154802.9025</td>
      <td>41.9904</td>
      <td>484.00</td>
    </tr>
    <tr>
      <th>865</th>
      <td>0.002248</td>
      <td>0.0</td>
      <td>142.3249</td>
      <td>0</td>
      <td>0.328329</td>
      <td>36.360900</td>
      <td>6528.64</td>
      <td>6.275025</td>
      <td>1</td>
      <td>74529.0</td>
      <td>441.0</td>
      <td>157529.6100</td>
      <td>62.0944</td>
      <td>141.61</td>
    </tr>
  </tbody>
</table>
<p>866 rows × 14 columns</p>
</div></div></div>
</div>
</section>
<section id="id15">
<h4>(b)<a class="headerlink" href="#id15" title="Permalink to this headline">#</a></h4>
<p>For binary attributes, the transformation would act as <span class="math notranslate nohighlight">\(and\)</span> logical operator. Binary attributes in the part of dataset with Linear form won’t change, but in the polynomial the binaries will be logically <span class="math notranslate nohighlight">\(and\)</span>.</p>
</section>
<section id="id16">
<h4>(c)<a class="headerlink" href="#id16" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main3_4.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Regression on housing dataset program!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
      CRIM    ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.00632  18.0   2.31     0  0.538  ...    1  296.0     15.3  396.90   4.98
1  0.02731   0.0   7.07     0  0.469  ...    2  242.0     17.8  396.90   9.14
2  0.02729   0.0   7.07     0  0.469  ...    2  242.0     17.8  392.83   4.03
3  0.03237   0.0   2.18     0  0.458  ...    3  222.0     18.7  394.63   2.94
4  0.06905   0.0   2.18     0  0.458  ...    3  222.0     18.7  396.90   5.33

[5 rows x 13 columns]
Test set head :
      CRIM   ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.84054  0.0   8.14     0  0.538  ...    4  307.0     21.0  303.42  16.51
1  0.67191  0.0   8.14     0  0.538  ...    4  307.0     21.0  376.88  14.81
2  0.95577  0.0   8.14     0  0.538  ...    4  307.0     21.0  306.38  17.28
3  0.77299  0.0   8.14     0  0.538  ...    4  307.0     21.0  387.94  12.80
4  1.00245  0.0   8.14     0  0.538  ...    4  307.0     21.0  380.23  11.98

[5 rows x 13 columns]
----------------------------------------------------------------------
----------------------------------------------------------------------
Training: 
Mean Squared Error: 55343.71451079023
Testing using the last trained weights: 
Test
Mean Squared Error: 35394.311865625714
----------------------------------------------------------------------
Weights of the training
[-4.68476601e-02  4.08283559e-02  8.30964818e-02  1.09347853e+02
 -2.39244676e+02  3.05351274e+01  2.35384427e-03 -5.57037854e+00
  8.67934356e-01 -1.28788975e-03 -1.50542358e+00  1.40912747e-03
 -3.64281060e-01]
----------------------------------------------------------------------
----------------------------------------------------------------------
Incremental Learning
Training
Mean Squared Error: 0.7264756830925618
Test
Mean Squared Error: 35097170.23443318
----------------------------------------------------------------------
Final wights of Incremental Learning
[-4.68476601e-02  4.08283559e-02  8.30964818e-02  1.09347853e+02
 -2.39244676e+02  3.05351274e+01  2.35384427e-03 -5.57037854e+00
  8.67934356e-01 -1.28788975e-03 -1.50542358e+00  1.40912747e-03
 -3.64281060e-01]
----------------------------------------------------------------------
Partial Wights
Plotting Training and Test Loss
Figure(1500x500)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main3_4.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Regression on housing dataset program!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
      CRIM    ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.00632  18.0   2.31     0  0.538  ...    1  296.0     15.3  396.90   4.98
1  0.02731   0.0   7.07     0  0.469  ...    2  242.0     17.8  396.90   9.14
2  0.02729   0.0   7.07     0  0.469  ...    2  242.0     17.8  392.83   4.03
3  0.03237   0.0   2.18     0  0.458  ...    3  222.0     18.7  394.63   2.94
4  0.06905   0.0   2.18     0  0.458  ...    3  222.0     18.7  396.90   5.33

[5 rows x 13 columns]
Test set head :
      CRIM   ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.84054  0.0   8.14     0  0.538  ...    4  307.0     21.0  303.42  16.51
1  0.67191  0.0   8.14     0  0.538  ...    4  307.0     21.0  376.88  14.81
2  0.95577  0.0   8.14     0  0.538  ...    4  307.0     21.0  306.38  17.28
3  0.77299  0.0   8.14     0  0.538  ...    4  307.0     21.0  387.94  12.80
4  1.00245  0.0   8.14     0  0.538  ...    4  307.0     21.0  380.23  11.98

[5 rows x 13 columns]
----------------------------------------------------------------------
----------------------------------------------------------------------
Training: 
Mean Squared Error: 55343.71451079023
Testing using the last trained weights: 
Test
Mean Squared Error: 35394.311865625714
----------------------------------------------------------------------
Weights of the training
[-4.68476601e-02  4.08283559e-02  8.30964818e-02  1.09347853e+02
 -2.39244676e+02  3.05351274e+01  2.35384427e-03 -5.57037854e+00
  8.67934356e-01 -1.28788975e-03 -1.50542358e+00  1.40912747e-03
 -3.64281060e-01]
----------------------------------------------------------------------
----------------------------------------------------------------------
Incremental Learning
Training
Mean Squared Error: 2.9753029489387566e+38
Test
Mean Squared Error: 1.1151099259756206e+46
----------------------------------------------------------------------
Final wights of Incremental Learning
[-4.68476601e-02  4.08283559e-02  8.30964818e-02  1.09347853e+02
 -2.39244676e+02  3.05351274e+01  2.35384427e-03 -5.57037854e+00
  8.67934356e-01 -1.28788975e-03 -1.50542358e+00  1.40912747e-03
 -3.64281060e-01]
----------------------------------------------------------------------
Partial Wights
Plotting Training and Test Loss
Figure(1500x500)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main3_4.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">0</span>.5
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Regression on housing dataset program!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
      CRIM    ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.00632  18.0   2.31     0  0.538  ...    1  296.0     15.3  396.90   4.98
1  0.02731   0.0   7.07     0  0.469  ...    2  242.0     17.8  396.90   9.14
2  0.02729   0.0   7.07     0  0.469  ...    2  242.0     17.8  392.83   4.03
3  0.03237   0.0   2.18     0  0.458  ...    3  222.0     18.7  394.63   2.94
4  0.06905   0.0   2.18     0  0.458  ...    3  222.0     18.7  396.90   5.33

[5 rows x 13 columns]
Test set head :
      CRIM   ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.84054  0.0   8.14     0  0.538  ...    4  307.0     21.0  303.42  16.51
1  0.67191  0.0   8.14     0  0.538  ...    4  307.0     21.0  376.88  14.81
2  0.95577  0.0   8.14     0  0.538  ...    4  307.0     21.0  306.38  17.28
3  0.77299  0.0   8.14     0  0.538  ...    4  307.0     21.0  387.94  12.80
4  1.00245  0.0   8.14     0  0.538  ...    4  307.0     21.0  380.23  11.98

[5 rows x 13 columns]
----------------------------------------------------------------------
----------------------------------------------------------------------
Training: 
Mean Squared Error: 55343.71451079023
Testing using the last trained weights: 
Test
Mean Squared Error: 35394.311865625714
----------------------------------------------------------------------
Weights of the training
[-4.68476601e-02  4.08283559e-02  8.30964818e-02  1.09347853e+02
 -2.39244676e+02  3.05351274e+01  2.35384427e-03 -5.57037854e+00
  8.67934356e-01 -1.28788975e-03 -1.50542358e+00  1.40912747e-03
 -3.64281060e-01]
----------------------------------------------------------------------
----------------------------------------------------------------------
Incremental Learning
Training
Mean Squared Error: 0.0
Test
Mean Squared Error: 0.0
----------------------------------------------------------------------
Final wights of Incremental Learning
[-4.68476601e-02  4.08283559e-02  8.30964818e-02  1.09347853e+02
 -2.39244676e+02  3.05351274e+01  2.35384427e-03 -5.57037854e+00
  8.67934356e-01 -1.28788975e-03 -1.50542358e+00  1.40912747e-03
 -3.64281060e-01]
----------------------------------------------------------------------
Partial Wights
Plotting Training and Test Loss
Figure(1500x500)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main3_4.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">0</span>.01
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Regression on housing dataset program!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
      CRIM    ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.00632  18.0   2.31     0  0.538  ...    1  296.0     15.3  396.90   4.98
1  0.02731   0.0   7.07     0  0.469  ...    2  242.0     17.8  396.90   9.14
2  0.02729   0.0   7.07     0  0.469  ...    2  242.0     17.8  392.83   4.03
3  0.03237   0.0   2.18     0  0.458  ...    3  222.0     18.7  394.63   2.94
4  0.06905   0.0   2.18     0  0.458  ...    3  222.0     18.7  396.90   5.33

[5 rows x 13 columns]
Test set head :
      CRIM   ZN  INDUS  CHAS    NOX  ...  RAD    TAX  PTRATIO       B  LSTAT
0  0.84054  0.0   8.14     0  0.538  ...    4  307.0     21.0  303.42  16.51
1  0.67191  0.0   8.14     0  0.538  ...    4  307.0     21.0  376.88  14.81
2  0.95577  0.0   8.14     0  0.538  ...    4  307.0     21.0  306.38  17.28
3  0.77299  0.0   8.14     0  0.538  ...    4  307.0     21.0  387.94  12.80
4  1.00245  0.0   8.14     0  0.538  ...    4  307.0     21.0  380.23  11.98

[5 rows x 13 columns]
----------------------------------------------------------------------
----------------------------------------------------------------------
Training: 
Mean Squared Error: 55343.71451079023
Testing using the last trained weights: 
Test
Mean Squared Error: 35394.311865625714
----------------------------------------------------------------------
Weights of the training
[-4.68476601e-02  4.08283559e-02  8.30964818e-02  1.09347853e+02
 -2.39244676e+02  3.05351274e+01  2.35384427e-03 -5.57037854e+00
  8.67934356e-01 -1.28788975e-03 -1.50542358e+00  1.40912747e-03
 -3.64281060e-01]
----------------------------------------------------------------------
----------------------------------------------------------------------
Incremental Learning
Training
Mean Squared Error: 0.31370632734922127
Test
Mean Squared Error: 89882561.46377167
----------------------------------------------------------------------
Final wights of Incremental Learning
[-4.68476601e-02  4.08283559e-02  8.30964818e-02  1.09347853e+02
 -2.39244676e+02  3.05351274e+01  2.35384427e-03 -5.57037854e+00
  8.67934356e-01 -1.28788975e-03 -1.50542358e+00  1.40912747e-03
 -3.64281060e-01]
----------------------------------------------------------------------
Partial Wights
Plotting Training and Test Loss
Figure(1500x500)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id17">
<h4>(d)<a class="headerlink" href="#id17" title="Permalink to this headline">#</a></h4>
<p>Comparing the plotted losses shows that there is no big differences between both parts c and d, but there are some minor differences comparing between them. For example using the <span class="math notranslate nohighlight">\(\frac{2}{t}\)</span> learning rate shows that the extended version of the dataset achieves the best results later than the linear version. But in contrast we can say that the we can achieve better results with linear version in more early steps.</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./HW1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="README.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Homework no.1 Machine Learning</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../HW2/main.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Homework no.2</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Jupyter Book community<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>