
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Homework no.2 &#8212; My Jupyter Book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Homework no.3 Machine Learning" href="../HW3/main.html" />
    <link rel="prev" title="HomeWork #1 Machine Learning" href="../HW1/main.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">My Jupyter Book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Machine Learning Homeworks
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../HW1/README.html">
   Homework no.1 Machine Learning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../HW1/main.html">
     HomeWork #1 Machine Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Homework no.2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../HW3/main.html">
   Homework no.3 Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../HW4/main.html">
   Homework no.4 Machine Learning
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/HW2/main.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/HW2/main.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Homework no.2
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q1">
   Q1
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p1">
     P1
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p2">
     P2
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p3">
     P3
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p4">
     P4
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q2">
   Q2
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q3">
   Q3
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     P1
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     P2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q4">
   Q4
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     P1
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p2-p3-p4">
     P2, P3, P4
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p5">
     P5
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p6">
     P6
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q5">
   Q5
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q6">
   Q6
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q7">
   Q7
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q8">
   Q8
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q9">
   Q9
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q10">
   Q10
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Homework no.2</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Homework no.2
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q1">
   Q1
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p1">
     P1
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p2">
     P2
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p3">
     P3
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p4">
     P4
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q2">
   Q2
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q3">
   Q3
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     P1
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     P2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q4">
   Q4
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     P1
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p2-p3-p4">
     P2, P3, P4
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p5">
     P5
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#p6">
     P6
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q5">
   Q5
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q6">
   Q6
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q7">
   Q7
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q8">
   Q8
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q9">
   Q9
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#q10">
   Q10
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="homework-no-2">
<h1>Homework no.2<a class="headerlink" href="#homework-no-2" title="Permalink to this headline">#</a></h1>
<p><strong>Student name:</strong> Mohammad Amin Dadgar <br>
<strong>Student Id:</strong> 4003624016</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="q1">
<h1>Q1<a class="headerlink" href="#q1" title="Permalink to this headline">#</a></h1>
<p>Using the training set below answer these question.
\begin{equation}
\text{Training Set }= {(0.5, 2), (0.7, 3),(1, 8), (1.5, 10), (2, 10.3), (2.7, 5.5), (3, 8), (3.3, 11), (4, 10.2), (4.3, 12)}
\end{equation}
Each data is <span class="math notranslate nohighlight">\((x_i, y_i)\)</span></p>
<section id="p1">
<h2>P1<a class="headerlink" href="#p1" title="Permalink to this headline">#</a></h2>
<p>fit the model <span class="math notranslate nohighlight">\(y=ax^2+bx+c\)</span> on the given dataset and name the model as model_1. This means
\begin{equation}
\phi_1(x) =
\begin{bmatrix}
1 \
x \
x^2 \
\end{bmatrix}
\end{equation}
And the weights matrix is
\begin{equation}
W_1 =
\begin{bmatrix}
c \
b \
a \
\end{bmatrix}
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">model_1</span><span class="p">(</span><span class="n">training_set</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Linear Regression using quadratic function as the kernel function</span>

<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    training_set : array of tuples</span>
<span class="sd">        array of `x_i` and `y_i`</span>
<span class="sd">        `x` the input variables</span>
<span class="sd">        `y` are the output variables</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">    w : matrix_like</span>
<span class="sd">        the matrix of learned weights</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## Extract the X values and covert them using kernel function</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">training_set</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    
    <span class="c1">## apply the quadratic function to input data</span>
    <span class="n">X_phi</span> <span class="o">=</span> <span class="n">kernel_Quadratic</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="c1">## extract the outputs</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">training_set</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="c1">## the `A` and `b` parameters of a Linear Regression function</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">X_phi</span> <span class="o">@</span> <span class="n">X_phi</span><span class="o">.</span><span class="n">T</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X_phi</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">w</span>
    
    
<span class="k">def</span> <span class="nf">kernel_Quadratic</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The quadratic kernel function</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        the variables to be converted</span>
<span class="sd">   </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    phi : array_like</span>
<span class="sd">        the quadratic function applied to `X`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## first convert to a numpy array and copy it</span>
    <span class="n">X_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="n">ones_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
    <span class="n">ones_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">ones_arr</span><span class="p">)</span>
    
    <span class="n">X_power_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">ones_arr</span><span class="p">,</span> <span class="n">X_new</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">X_power_2</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">phi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mf">0.7</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),(</span><span class="mf">1.5</span><span class="p">,</span><span class="mi">10</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mf">10.3</span><span class="p">),(</span><span class="mf">2.7</span><span class="p">,</span><span class="mf">5.5</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">),(</span><span class="mf">3.3</span><span class="p">,</span><span class="mi">11</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mf">10.2</span><span class="p">),(</span><span class="mf">4.3</span><span class="p">,</span><span class="mi">12</span><span class="p">)]</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model1_weight</span> <span class="o">=</span> <span class="n">model_1</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">model1_weight</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>matrix([[ 1.94132333],
        [ 4.13814418],
        [-0.49656258]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="p2">
<h2>P2<a class="headerlink" href="#p2" title="Permalink to this headline">#</a></h2>
<p>fit the model <span class="math notranslate nohighlight">\(y=ax^3+bx^2+cx+d\)</span> on the given dataset and name the model as model_2. This means
\begin{equation}
\phi_2(x) =
\begin{bmatrix}
1 \
x \
x^2 \
x^3 \
\end{bmatrix}
\end{equation}
And the weights matrix is
\begin{equation}
W_2 =
\begin{bmatrix}
d \
c \
b \
a \
\end{bmatrix}
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mode_2</span><span class="p">(</span><span class="n">training_set</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Linear Regression function using ```ax^3 + bx^2 + cx + d``` as kernel function</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    training_set : array of tuples</span>
<span class="sd">        array of `x_i` and `y_i`</span>
<span class="sd">        `x` the input variables</span>
<span class="sd">        `y` are the output variables</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    ----------</span>
<span class="sd">    w : matrix_like</span>
<span class="sd">        the matrix of learned weights</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">## Extract the X values and covert them using kernel function</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">training_set</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    
    <span class="c1">## apply the quadratic function to input data</span>
    <span class="n">X_phi</span> <span class="o">=</span> <span class="n">kernel_cubic</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="c1">## extract the outputs</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">training_set</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="c1">## the `A` and `b` parameters of a Linear Regression function</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">X_phi</span> <span class="o">@</span> <span class="n">X_phi</span><span class="o">.</span><span class="n">T</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X_phi</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">w</span>

<span class="k">def</span> <span class="nf">kernel_cubic</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The cubic function</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        the variables to be converted</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    phi : array_like</span>
<span class="sd">        the quadratic function applied to `X`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1">## first convert to a numpy array and copy it</span>
    <span class="n">X_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="n">ones_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
    <span class="n">ones_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">ones_arr</span><span class="p">)</span>
    
    <span class="n">X_power_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">X_power_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">ones_arr</span><span class="p">,</span> <span class="n">X_new</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">X_power_2</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">X_power_3</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">phi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model2_weight</span> <span class="o">=</span> <span class="n">mode_2</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">model2_weight</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>matrix([[-7.33397387],
        [22.63114975],
        [-9.53106286],
        [ 1.24181752]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="p3">
<h2>P3<a class="headerlink" href="#p3" title="Permalink to this headline">#</a></h2>
<p>Calculate the MSE for <span class="math notranslate nohighlight">\(\text{model}_1\)</span> and <span class="math notranslate nohighlight">\(\text{model}_2\)</span> using the dataset below
\begin{equation}
\text{Test set }= {(3.8, 12.9), (1, 9),(2, 8), (1.9, 9), (1.5, 7), (1.6, 9.5), (1.2, 10), (3.3, 11), (1.5, 11), (4, 6)}
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(((</span><span class="mf">3.8</span><span class="p">,</span> <span class="mf">12.9</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.9</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> 
                    <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mf">3.3</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
                    <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)))</span>
<span class="n">test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 3.8, 12.9],
       [ 1. ,  9. ],
       [ 2. ,  8. ],
       [ 1.9,  9. ],
       [ 1.5,  7. ],
       [ 1.6,  9.5],
       [ 1.2, 10. ],
       [ 3.3, 11. ],
       [ 1.5, 11. ],
       [ 4. ,  6. ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## applying model_1</span>
<span class="k">def</span> <span class="nf">model_predict</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    predict the output of a model in this question </span>
<span class="sd">    using the trained weights for the data</span>
<span class="sd">    </span>
<span class="sd">    the desired model can be selected using the quadratic or the cubic parameter</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    weights : array_like</span>
<span class="sd">        the learned parameters for model1</span>
<span class="sd">    data : array or scaler</span>
<span class="sd">        the desired data for prediction task</span>
<span class="sd">    kwargs : </span>
<span class="sd">        quadratics : use the model_1 in this question </span>
<span class="sd">        cubic : use the model_2 in this question</span>
<span class="sd">        </span>
<span class="sd">    **NOTE:** one of the parameters can be choosed!</span>
<span class="sd">    **NOTE:** any value can be passed to kwargs, there is no difference in that. (because the value would not be used)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    prediction : array or scaler</span>
<span class="sd">        the predicted output value for the input data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1">## first we need to apply the transformation for the data </span>
    <span class="c1">## as the learned parameters are trained using the transformation</span>
    <span class="k">if</span> <span class="s1">&#39;quadratics&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s1">&#39;cubic&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Both parameters cannot be chosen! They have different behaviour&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s1">&#39;quadratics&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">data_phi</span> <span class="o">=</span> <span class="n">kernel_Quadratic</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> 
    <span class="k">elif</span> <span class="s1">&#39;cubic&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">data_phi</span> <span class="o">=</span> <span class="n">kernel_cubic</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;no parameters cubic or quadratics was chosen!&quot;</span><span class="p">)</span>
        
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">data_phi</span>
    
    <span class="k">return</span> <span class="n">prediction</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_MSE</span><span class="p">(</span><span class="n">true_outputs</span><span class="p">,</span> <span class="n">predicted_outputs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    calculate the Mean Squared Error for the predicted data</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    true_outputs : array_like </span>
<span class="sd">        the actual output of the data</span>
<span class="sd">    predicted_outputs : array_like</span>
<span class="sd">        the predicted outputs for the data</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    mse_value : float</span>
<span class="sd">        the mean squared error value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1">## the difference </span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">predicted_outputs</span> <span class="o">-</span> <span class="n">true_outputs</span>
    <span class="c1">## squeare the difference</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    
    <span class="c1">## find the mean value</span>
    <span class="n">mse_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">mse_value</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_model1_test</span> <span class="o">=</span> <span class="n">model_predict</span><span class="p">(</span><span class="n">model1_weight</span><span class="p">,</span> <span class="n">test</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">quadratics</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
<span class="n">pred_model2_test</span> <span class="o">=</span> <span class="n">model_predict</span><span class="p">(</span><span class="n">model2_weight</span><span class="p">,</span> <span class="n">test</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">cubic</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mse_model1</span> <span class="o">=</span> <span class="n">calculate_MSE</span><span class="p">(</span><span class="n">test</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">pred_model1_test</span><span class="p">)</span>
<span class="n">mse_model2</span> <span class="o">=</span> <span class="n">calculate_MSE</span><span class="p">(</span><span class="n">test</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">pred_model2_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MSE for model1 is </span><span class="si">{</span><span class="n">mse_model1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MSE for model2 is </span><span class="si">{</span><span class="n">mse_model2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE for model1 is 7.496789449073051
MSE for model2 is 5.812331603917104
</pre></div>
</div>
</div>
</div>
</section>
<section id="p4">
<h2>P4<a class="headerlink" href="#p4" title="Permalink to this headline">#</a></h2>
<p>To find the T value for our datasets we need to use the equation below
\begin{equation}
T = \frac{mean_1 - mean_2}{\frac{std(diffrences)}{\sqrt{n}}}
\end{equation}
refrence: <a class="reference external" href="https://www.investopedia.com/terms/t/t-test.asp">https://www.investopedia.com/terms/t/t-test.asp</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_T_value</span><span class="p">(</span><span class="n">dataset1</span><span class="p">,</span> <span class="n">dataset2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the T-value for two datasets</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    dataset1 : array_of_Tuples</span>
<span class="sd">        (`x_i`, `y_i`) data, `x` representing data and `y` representig label</span>
<span class="sd">    dataset2 : array_of_Tuples</span>
<span class="sd">        (`x_i`, `y_i`) data, `x` representing data and `y` representig label</span>

<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    T_value : float</span>
<span class="sd">        the T value for datasets</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## convert to numpy array for ease of use</span>
    <span class="n">set1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dataset1</span><span class="p">)</span>
    <span class="n">set2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dataset2</span><span class="p">)</span>
    
    <span class="c1">## calculate the medians</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">set1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">set2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    
    <span class="c1">## find the differences</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">set1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">set2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    
    <span class="c1">## below the division</span>
    <span class="n">below</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">diff</span><span class="p">))</span>
    
    <span class="n">above</span> <span class="o">=</span> <span class="n">m1</span> <span class="o">-</span> <span class="n">m2</span>
    
    <span class="n">T_value</span> <span class="o">=</span> <span class="n">above</span> <span class="o">/</span> <span class="n">below</span>
    
    <span class="k">return</span> <span class="n">T_value</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calculate_T_value</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.9350212787977713
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">test</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">test</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0609315717988514
</pre></div>
</div>
</div>
</div>
<p>As we can see the value for T-test is about <code class="docutils literal notranslate"><span class="pre">-0.935</span></code> and it is not out of the [-1.96, 1.96].</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="q2">
<h1>Q2<a class="headerlink" href="#q2" title="Permalink to this headline">#</a></h1>
<p><strong>Explain the friedman test.</strong></p>
<p>Friedman test is one another tests used in statistics to measure the different values between different tests. Friedman test should have three assumptions: <span class="math notranslate nohighlight">\((1)\)</span> Data in each test must be continues <span class="math notranslate nohighlight">\((2)\)</span> Data retrieved in each test must be random, for example choosing random patients in order to analyze a drug effect. If the data wasn’t randomly selected, We would have bias in results and results cannot be trusted. <span class="math notranslate nohighlight">\((3)\)</span> Data retrieved in each group must be enough. Having few data samples could occur bias in results.</p>
<p>To explain this test in more detail we can say this is another version of analyze of the variance test (ANOVA). In ANOVA we analyze a value in different dependent test but in friedman test, the rank of the data is compared and after that the chi-square and p values are calculated. Using the table of chi-squared distribution and comparing it to the computed chi-square we can find out the null hypothesis is rejected or not. If the value of chi-square is less than the founded value in chi-square table then the null hypothesis is not rejected and there is no difference between the responsiveness at different time points.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="q3">
<h1>Q3<a class="headerlink" href="#q3" title="Permalink to this headline">#</a></h1>
<p>Use housing data in Homework no.1 and the linear regression model. The kernel function is
\begin{equation}
\phi_j(x) = exp[-\frac{1}{2} \beta (x-m_j)^T(x-m_j)]
\end{equation}
Find the parameters of the weight <span class="math notranslate nohighlight">\(w\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CRIM&#39;</span><span class="p">,</span> <span class="s1">&#39;ZN&#39;</span><span class="p">,</span> <span class="s1">&#39;INDUS&#39;</span><span class="p">,</span> <span class="s1">&#39;CHAS&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">,</span> <span class="s1">&#39;RM&#39;</span><span class="p">,</span> <span class="s1">&#39;AGE&#39;</span><span class="p">,</span> <span class="s1">&#39;DIS&#39;</span><span class="p">,</span> <span class="s1">&#39;RAD&#39;</span><span class="p">,</span><span class="s1">&#39;TAX&#39;</span><span class="p">,</span> <span class="s1">&#39;PTRATIO&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTAT&#39;</span><span class="p">,</span> <span class="s1">&#39;MEDV&#39;</span><span class="p">]</span>

<span class="n">df_housing</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../HW1/hw1_data/housing/housing.txt&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; +&#39;</span>
            <span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_housing</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
      <th>MEDV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1</td>
      <td>296.0</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
      <td>21.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
      <td>34.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
      <td>33.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
      <td>36.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_housing</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(506, 14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## removing label</span>
<span class="n">df_X</span> <span class="o">=</span> <span class="n">df_housing</span><span class="p">[</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1</td>
      <td>296.0</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id1">
<h2>P1<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<p>Using
\begin{equation}
\phi_j(x) = exp[-\frac{1}{2} \beta (x-m_j)^T(x-m_j)]
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main2_4_1.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">0</span> <span class="nv">iterations</span><span class="o">=</span><span class="m">500</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Regression on classification dataset!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
[[ 1.01282826  4.01649081  1.65647289 13.2619483   1.15354131  1.06494048
   1.07111885  1.00458072  4.40342042  1.07956694]
 [ 1.06031624  6.10072219  1.83830247 20.13251952  1.33604887  1.0121326
   1.08259325  1.02583593  6.68167274  1.22564921]]
Test set head :
[[ 1.1035626   3.90739883  1.1927901   6.89767518  1.18865428  1.18089521
   1.22723299  1.08127911  3.65352341  1.19721517]
 [ 1.03688092  3.65448769  1.4859806  10.54206949  1.11699903  1.09818608
   1.14145285  1.00633977  3.86608794  1.12006533]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Closed Form Training: </span>
 Train Error: 
  Mean Squared Error:
 [61.89315891]
 Test Error: 
  5184.793971193906
 Final Weights of the closed form training
[[ 55.43584553]
 [-33.28978507]
 [ -3.62285238]
 [ -3.05717393]
 [ 24.25689617]
 [ 16.36590991]
 [-47.56391815]
 [-10.09092706]
 [ 38.31770048]
 [ -3.69446901]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Incremental Learning (Online GD) </span>
  Training Error:
   MSE:[30.25776804]
  Test Error:
   MSE:4502459.01443338

 Final wights of Incremental Learning
[[ -2.93593411]
 [-24.61501897]
 [ 17.80302619]
 [ 37.11704268]
 [  6.64056529]
 [ -1.38367835]
 [ -3.17517381]
 [ -0.0943037 ]
 [ -4.28366212]
 [ -7.53687668]]
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2>P2<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<p>And using the other kernel function
\begin{equation}
\phi_j(x) = \sigma{a||x-m_j||}
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main2_4_1.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">0</span> <span class="nv">iterations</span><span class="o">=</span><span class="m">500</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Regression on classification dataset!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
[[ 1.15354131  4.40342042  1.00458072 13.2619483   1.06494048  4.01649081
   1.01282826  1.65647289  1.07111885  1.07956694]
 [ 1.33604887  6.68167274  1.02583593 20.13251952  1.0121326   6.10072219
   1.06031624  1.83830247  1.08259325  1.22564921]]
Test set head :
[[ 1.18865428  3.65352341  1.08127911  6.89767518  1.18089521  3.90739883
   1.1035626   1.1927901   1.22723299  1.19721517]
 [ 1.11699903  3.86608794  1.00633977 10.54206949  1.09818608  3.65448769
   1.03688092  1.4859806   1.14145285  1.12006533]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Closed Form Training: </span>
 Train Error: 
  Mean Squared Error:
 [61.89315891]
 Test Error: 
  5184.79397154851
 Final Weights of the closed form training
[[ 24.25689617]
 [ 38.31770048]
 [-10.09092705]
 [ -3.05717393]
 [ 16.36590991]
 [-33.28978507]
 [ 55.43584553]
 [ -3.62285238]
 [-47.56391815]
 [ -3.69446901]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Incremental Learning (Online GD) </span>
  Training Error:
   MSE:[30.25776804]
  Test Error:
   MSE:4502459.014433393

 Final wights of Incremental Learning
[[  6.64056529]
 [ -4.28366212]
 [ -0.0943037 ]
 [ 37.11704268]
 [ -1.38367835]
 [-24.61501897]
 [ -2.93593411]
 [ 17.80302619]
 [ -3.17517381]
 [ -7.53687668]]
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<p>We’ve set the <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> value to <span class="math notranslate nohighlight">\(0.00001\)</span>. Setting these hyperparameters to higher values near and more than <span class="math notranslate nohighlight">\(1\)</span> can occur overflow due to very high values. So the best values can be around <span class="math notranslate nohighlight">\(10^{-4}\)</span>.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="q4">
<h1>Q4<a class="headerlink" href="#q4" title="Permalink to this headline">#</a></h1>
<section id="id3">
<h2>P1<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h2>
<p>Plot the training and the test data and answer the question that “Are the data linearly separable?”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">]</span>
<span class="n">train_ds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./hw2_data/classification_trn.txt&#39;</span><span class="p">,</span>
                       <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; +&#39;</span><span class="p">,</span>
                      <span class="n">names</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
                      <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="n">train_ds</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(250, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_ds</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.462766</td>
      <td>0.339111</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.779089</td>
      <td>0.894436</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.067501</td>
      <td>0.846257</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.048451</td>
      <td>0.142165</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.529524</td>
      <td>0.792441</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">]</span>
<span class="n">test_ds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./hw2_data/classification_tst.txt&#39;</span><span class="p">,</span>
                       <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; +&#39;</span><span class="p">,</span>
                      <span class="n">names</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
                      <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="n">test_ds</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## plotting the training data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;Traning Data&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span>
                                                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_42_0.png" src="../_images/main_42_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## plotting the test data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">test_ds</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
                <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;Test Data&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span>
                                                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_43_0.png" src="../_images/main_43_0.png" />
</div>
</div>
<p>It is possible to see that the data is not linearly separable in training set.</p>
</section>
<section id="p2-p3-p4">
<h2>P2, P3, P4<a class="headerlink" href="#p2-p3-p4" title="Permalink to this headline">#</a></h2>
<p><strong>Question</strong>: Find the gradient descent formulas in order to maximize the likelihood of the regression and using the initial weights as <span class="math notranslate nohighlight">\(1\)</span> apply the learning rate <span class="math notranslate nohighlight">\(\frac{1}{t}\)</span>. (<span class="math notranslate nohighlight">\(t\)</span> is the time steps <span class="math notranslate nohighlight">\(1, 2, ..., T\)</span>)</p>
<p>\begin{equation}
W^{new} \leftarrow W^{old} + \alpha(i)\sum_{i=1}^{n} \big( y_i - f(x_i, W^{old})\big) x_{i} \
\text{Where }\alpha(i) = \frac{1}{i} \text{ For i=1, 2, …}
\end{equation}</p>
<p>The <code class="docutils literal notranslate"><span class="pre">learning_rate=0</span></code> corresponds to <span class="math notranslate nohighlight">\(\frac{2}{t}\)</span> and the <code class="docutils literal notranslate"><span class="pre">learning_rate=1</span></code> corresponds to <span class="math notranslate nohighlight">\(\frac{1}{\sqrt{t}}\)</span>.
Also the iterations can be adjusted using the argument <code class="docutils literal notranslate"><span class="pre">iterations</span></code>.</p>
<p>The errors are plotted in images that are saved within the HW2 folder.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main2_5.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">0</span> <span class="nv">iterations</span><span class="o">=</span><span class="m">500</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Logistic Regression on housing dataset!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
          X         Y
0  0.462766  0.339111
1  0.779089  0.894436
2  0.067501  0.846257
3 -0.048451  0.142165
4 -0.529524  0.792441
Test set head :
          X         Y
0 -0.521659  0.363769
1 -0.993098 -0.295949
2  2.083345  1.483410
3 -0.866462  0.166879
4 -1.182918 -0.075403
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Closed Form Training: </span>
 Train Error: 
  Mean Squared Error: 0.18533821040260134
 Test Error: 
  0.28
 Final Weights of the closed form training
[-0.10041674  0.74624728]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Gradient descent For Logistic Regression with T=500 iterations</span>
 Train Errors: 
  MSE: [21.179730570075883]
 Test Error: 
  MSE: 7.0

 Final wights of Offline Gradient Descent Learning
[[2.66828095]
 [2.44634553]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Incremental Learning (Online GD) </span>
  Training Error:
   MSE:[[0.7290789712448449, 0.07]]
  Test Error:
   MSE:0.07

 Final wights of Incremental Learning
[4.0564108  3.72600682]
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
</section>
<section id="p5">
<h2>P5<a class="headerlink" href="#p5" title="Permalink to this headline">#</a></h2>
<p>The learning rate is <span class="math notranslate nohighlight">\(\frac{1}{t}\)</span> in the cell below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main2_5.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">1</span> <span class="nv">iterations</span><span class="o">=</span><span class="m">500</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Logistic Regression on housing dataset!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
          X         Y
0  0.462766  0.339111
1  0.779089  0.894436
2  0.067501  0.846257
3 -0.048451  0.142165
4 -0.529524  0.792441
Test set head :
          X         Y
0 -0.521659  0.363769
1 -0.993098 -0.295949
2  2.083345  1.483410
3 -0.866462  0.166879
4 -1.182918 -0.075403
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Closed Form Training: </span>
 Train Error: 
  Mean Squared Error: 0.18533821040260134
 Test Error: 
  0.28
 Final Weights of the closed form training
[-0.10041674  0.74624728]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Gradient descent For Logistic Regression with T=500 iterations</span>
 Train Errors: 
  MSE: [21.514205312276683]
 Test Error: 
  MSE: 7.0

 Final wights of Offline Gradient Descent Learning
[[3.81875707]
 [3.33814397]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Incremental Learning (Online GD) </span>
  Training Error:
   MSE:[[0.7268892378981953, 0.07]]
  Test Error:
   MSE:0.07

 Final wights of Incremental Learning
[13.60834642 14.01209199]
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<p>And using static learning rate <code class="docutils literal notranslate"><span class="pre">0.5</span></code> in below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main2_5.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">0</span>.5 <span class="nv">iterations</span><span class="o">=</span><span class="m">500</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Logistic Regression on housing dataset!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
          X         Y
0  0.462766  0.339111
1  0.779089  0.894436
2  0.067501  0.846257
3 -0.048451  0.142165
4 -0.529524  0.792441
Test set head :
          X         Y
0 -0.521659  0.363769
1 -0.993098 -0.295949
2  2.083345  1.483410
3 -0.866462  0.166879
4 -1.182918 -0.075403
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Closed Form Training: </span>
 Train Error: 
  Mean Squared Error: 0.18533821040260134
 Test Error: 
  0.28
 Final Weights of the closed form training
[-0.10041674  0.74624728]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Gradient descent For Logistic Regression with T=500 iterations</span>
 Train Errors: 
  MSE: [22.45222254661859]
 Test Error: 
  MSE: 8.0

 Final wights of Offline Gradient Descent Learning
[[6.0130267 ]
 [4.98060682]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Incremental Learning (Online GD) </span>
  Training Error:
   MSE:[[0.7357933632670419, 0.07]]
  Test Error:
   MSE:0.07

 Final wights of Incremental Learning
[75.46032218 77.3744382 ]
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<p>In high iteration counts there is no obvious difference between different learning rates (But it just seems the <span class="math notranslate nohighlight">\(\frac{2}{t}\)</span> learning rate is doing better). To find the difference we used 50 iterations in below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main2_5.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">0</span> <span class="nv">iterations</span><span class="o">=</span><span class="m">50</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Logistic Regression on housing dataset!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
          X         Y
0  0.462766  0.339111
1  0.779089  0.894436
2  0.067501  0.846257
3 -0.048451  0.142165
4 -0.529524  0.792441
Test set head :
          X         Y
0 -0.521659  0.363769
1 -0.993098 -0.295949
2  2.083345  1.483410
3 -0.866462  0.166879
4 -1.182918 -0.075403
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Closed Form Training: </span>
 Train Error: 
  Mean Squared Error: 0.18533821040260134
 Test Error: 
  0.28
 Final Weights of the closed form training
[-0.10041674  0.74624728]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Gradient descent For Logistic Regression with T=50 iterations</span>
 Train Errors: 
  MSE: [21.321777405908414]
 Test Error: 
  MSE: 7.0

 Final wights of Offline Gradient Descent Learning
[[2.34004787]
 [2.17965517]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Incremental Learning (Online GD) </span>
  Training Error:
   MSE:[[0.743316177460033, 0.07]]
  Test Error:
   MSE:0.07

 Final wights of Incremental Learning
[2.70364651 2.3125385 ]
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main2_5.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">1</span> <span class="nv">iterations</span><span class="o">=</span><span class="m">50</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Logistic Regression on housing dataset!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
          X         Y
0  0.462766  0.339111
1  0.779089  0.894436
2  0.067501  0.846257
3 -0.048451  0.142165
4 -0.529524  0.792441
Test set head :
          X         Y
0 -0.521659  0.363769
1 -0.993098 -0.295949
2  2.083345  1.483410
3 -0.866462  0.166879
4 -1.182918 -0.075403
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Closed Form Training: </span>
 Train Error: 
  Mean Squared Error: 0.18533821040260134
 Test Error: 
  0.28
 Final Weights of the closed form training
[-0.10041674  0.74624728]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Gradient descent For Logistic Regression with T=50 iterations</span>
 Train Errors: 
  MSE: [21.222015553883374]
 Test Error: 
  MSE: 7.0

 Final wights of Offline Gradient Descent Learning
[[2.59108759]
 [2.37625462]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Incremental Learning (Online GD) </span>
  Training Error:
   MSE:[[0.7267833093158856, 0.09]]
  Test Error:
   MSE:0.09

 Final wights of Incremental Learning
[4.70243878 5.20285994]
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## And static learning rate</span>
<span class="o">!</span>python3 scripts/main2_5.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">0</span>.5 <span class="nv">iterations</span><span class="o">=</span><span class="m">500</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Logistic Regression on housing dataset!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
          X         Y
0  0.462766  0.339111
1  0.779089  0.894436
2  0.067501  0.846257
3 -0.048451  0.142165
4 -0.529524  0.792441
Test set head :
          X         Y
0 -0.521659  0.363769
1 -0.993098 -0.295949
2  2.083345  1.483410
3 -0.866462  0.166879
4 -1.182918 -0.075403
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Closed Form Training: </span>
 Train Error: 
  Mean Squared Error: 0.18533821040260134
 Test Error: 
  0.28
 Final Weights of the closed form training
[-0.10041674  0.74624728]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Gradient descent For Logistic Regression with T=500 iterations</span>
 Train Errors: 
  MSE: [22.45222254661859]
 Test Error: 
  MSE: 8.0

 Final wights of Offline Gradient Descent Learning
[[6.0130267 ]
 [4.98060682]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Incremental Learning (Online GD) </span>
  Training Error:
   MSE:[[0.7357933632670419, 0.07]]
  Test Error:
   MSE:0.07

 Final wights of Incremental Learning
[75.46032218 77.3744382 ]
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<p>We lower the iteration counts more to see better the differences</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main2_5.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">0</span> <span class="nv">iterations</span><span class="o">=</span><span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Logistic Regression on housing dataset!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
          X         Y
0  0.462766  0.339111
1  0.779089  0.894436
2  0.067501  0.846257
3 -0.048451  0.142165
4 -0.529524  0.792441
Test set head :
          X         Y
0 -0.521659  0.363769
1 -0.993098 -0.295949
2  2.083345  1.483410
3 -0.866462  0.166879
4 -1.182918 -0.075403
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Closed Form Training: </span>
 Train Error: 
  Mean Squared Error: 0.18533821040260134
 Test Error: 
  0.28
 Final Weights of the closed form training
[-0.10041674  0.74624728]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Gradient descent For Logistic Regression with T=5 iterations</span>
 Train Errors: 
  MSE: [21.954185815907675]
 Test Error: 
  MSE: 7.0

 Final wights of Offline Gradient Descent Learning
[[1.90462057]
 [1.81567883]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Incremental Learning (Online GD) </span>
  Training Error:
   MSE:[[1.0534808105827163, 0.32000000000000006]]
  Test Error:
   MSE:0.32000000000000006

 Final wights of Incremental Learning
[ 0.82746549 -0.11811742]
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main2_5.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">1</span> <span class="nv">iterations</span><span class="o">=</span><span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Logistic Regression on housing dataset!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
          X         Y
0  0.462766  0.339111
1  0.779089  0.894436
2  0.067501  0.846257
3 -0.048451  0.142165
4 -0.529524  0.792441
Test set head :
          X         Y
0 -0.521659  0.363769
1 -0.993098 -0.295949
2  2.083345  1.483410
3 -0.866462  0.166879
4 -1.182918 -0.075403
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Closed Form Training: </span>
 Train Error: 
  Mean Squared Error: 0.18533821040260134
 Test Error: 
  0.28
 Final Weights of the closed form training
[-0.10041674  0.74624728]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Gradient descent For Logistic Regression with T=5 iterations</span>
 Train Errors: 
  MSE: [22.70260229673039]
 Test Error: 
  MSE: 7.0

 Final wights of Offline Gradient Descent Learning
[[1.6710624 ]
 [1.60624242]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Incremental Learning (Online GD) </span>
  Training Error:
   MSE:[[1.0748037987641088, 0.28]]
  Test Error:
   MSE:0.28

 Final wights of Incremental Learning
[ 0.5997547  -0.00995924]
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main2_5.py <span class="nv">learning_rate</span><span class="o">=</span><span class="m">0</span>.5 <span class="nv">iterations</span><span class="o">=</span><span class="m">5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Logistic Regression on housing dataset!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
          X         Y
0  0.462766  0.339111
1  0.779089  0.894436
2  0.067501  0.846257
3 -0.048451  0.142165
4 -0.529524  0.792441
Test set head :
          X         Y
0 -0.521659  0.363769
1 -0.993098 -0.295949
2  2.083345  1.483410
3 -0.866462  0.166879
4 -1.182918 -0.075403
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Closed Form Training: </span>
 Train Error: 
  Mean Squared Error: 0.18533821040260134
 Test Error: 
  0.28
 Final Weights of the closed form training
[-0.10041674  0.74624728]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Gradient descent For Logistic Regression with T=5 iterations</span>
 Train Errors: 
  MSE: [23.278982955755232]
 Test Error: 
  MSE: 7.0

 Final wights of Offline Gradient Descent Learning
[[1.54112266]
 [1.4904238 ]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Incremental Learning (Online GD) </span>
  Training Error:
   MSE:[[1.1067532327276703, 0.23]]
  Test Error:
   MSE:0.23

 Final wights of Incremental Learning
[0.42850402 0.02784965]
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<p>In the results we can see that there may be a little difference and the static learning rate <code class="docutils literal notranslate"><span class="pre">0.5</span></code> show the better results on Test Error in Incremental learning Gradient Descent.</p>
</section>
<section id="p6">
<h2>P6<a class="headerlink" href="#p6" title="Permalink to this headline">#</a></h2>
<p>Comparing the Incremental version of logisitic regression with the normal version shows that it can achive better results with high iteration counts.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="q5">
<h1>Q5<a class="headerlink" href="#q5" title="Permalink to this headline">#</a></h1>
<p>The data is used from the question 4 and Nive bayes method will be applied.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">probability_normal_distribution</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The probability value for normal distribution function</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    x : array_like</span>
<span class="sd">        the input data</span>
<span class="sd">    mu : float</span>
<span class="sd">        the mean value given</span>
<span class="sd">    sigma : float</span>
<span class="sd">        the variance given </span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    probability : float</span>
<span class="sd">        the probability value for the x input values </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## we&#39;ve divided the equation in two parts</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">X</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
    
    <span class="n">probability</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="n">p2</span>
    
    <span class="k">return</span> <span class="n">probability</span>
    
<span class="k">def</span> <span class="nf">find_MLE_Normal_distro</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    the maximum likelihood estimation for parameters of normal distribution</span>
<span class="sd">    the parameters for normal distribution is covariance matrix and mean vector</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        the X input data vectors</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    mu : array_like</span>
<span class="sd">        the means vector</span>
<span class="sd">    variance : matrix_like</span>
<span class="sd">        the matrix representing the covariance</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    
    <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    
    <span class="c1">## some changes was made to the ML estimation of variance</span>
    <span class="c1">## because of dataset shape</span>
    <span class="n">variance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>    
    
    <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">variance</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">]</span>
<span class="n">train_ds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./hw2_data/classification_trn.txt&#39;</span><span class="p">,</span>
                       <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; +&#39;</span><span class="p">,</span>
                      <span class="n">names</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
                      <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>

<span class="n">test_ds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./hw2_data/classification_tst.txt&#39;</span><span class="p">,</span>
                       <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; +&#39;</span><span class="p">,</span>
                      <span class="n">names</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
                      <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In Naive Bayes the class conditional density can be computed by
\begin{equation}
p(x|c=1) = \prod_{i=1}^{d} p(x_i | c=1) \
p(x|c=0) = \prod_{i=1}^{d} p(x_i | c=0)
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## divide the dataset into 0 and 1 labels</span>
<span class="k">def</span> <span class="nf">estimate_MLE_NB</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">features_arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    estimate the Maximum likelihood parameters for naive bayes method</span>
<span class="sd">    in detail: in naive bayes we have a parameter for each dimension and each class</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    X : array_like</span>
<span class="sd">        the input data (a pandas dataframe is prefered)</span>
<span class="sd">    Y : array_like</span>
<span class="sd">        the labels for each `X` inputs</span>
<span class="sd">    features : array_like</span>
<span class="sd">        the string array for the name of each label in training data (dimensions)</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    MLE_estimates : dictionary </span>
<span class="sd">        the estimated parameters as a dictionary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## dictionary of maximum likelihood estimations</span>
    <span class="n">MLE_estimates</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features_arr</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="n">mu</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">find_MLE_Normal_distro</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">Y</span> <span class="o">==</span> <span class="n">label</span><span class="p">][</span><span class="n">feature</span><span class="p">])</span>
            <span class="c1">## each feature of class estimation</span>
            <span class="n">MLE_estimates</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mu</span><span class="p">,</span> <span class="n">var</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">MLE_estimates</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##################### Code is Implemented in the function above #####################</span>

<span class="c1"># ## dictionary of maximum likelihood estimations</span>
<span class="c1"># MLE_estimates = {}</span>
<span class="c1"># for feature in [&#39;X&#39;, &#39;Y&#39;]:</span>
<span class="c1">#     for label in [0, 1]:</span>
<span class="c1">#         mu, var = find_MLE_Normal_distro(train_ds[train_ds.label == label][feature])</span>
<span class="c1">#         ## each feature of class estimation</span>
<span class="c1">#         MLE_estimates[f&#39;{feature},{label}&#39;] = [mu, var]</span>


<span class="n">MLE_estimates</span> <span class="o">=</span> <span class="n">estimate_MLE_NB</span><span class="p">(</span><span class="n">train_ds</span><span class="p">[[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">]],</span> <span class="n">train_ds</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MLE_estimates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;X,0&#39;: [-0.9766294551726316, 0.4043628347745132],
 &#39;X,1&#39;: [0.01564038684774194, 0.574343819845795],
 &#39;Y,0&#39;: [-0.04355836269157895, 0.42688761701060846],
 &#39;Y,1&#39;: [0.9415618305584516, 0.5324787748723679]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">predict_NB</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">MLE_estimations</span><span class="p">,</span> <span class="n">features_arr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    predict the class Using Naive bayes algorithm</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    X : pandas dataframe</span>
<span class="sd">        Input data, `X` and `Y` should be the features</span>
<span class="sd">    MLE_estimations : dictionary</span>
<span class="sd">        Maximum likelihood estimations corresponding to each dimension and class as a dictionary with keys like `X,0`</span>
<span class="sd">        meaning X as first feature and 0 as first class </span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    prediction : array_like</span>
<span class="sd">        the array representing the probability of each class for data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## the predicted value for each data</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="c1">## initialize Class probability array</span>
        <span class="n">class_p_arr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="c1">## multiply probability for each dimension</span>
            <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features_arr</span><span class="p">:</span>
                <span class="n">mu</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">MLE_estimations</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">probability_normal_distribution</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">feature</span><span class="p">],</span><span class="n">mu</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>
            <span class="n">class_p_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="c1">## save each class probability of each data</span>
        <span class="n">prediction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_p_arr</span><span class="p">)</span>
    
    <span class="c1">## for ease of use convert to numpy</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">prediction</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span>  <span class="o">=</span> <span class="n">predict_NB</span><span class="p">(</span><span class="n">train_ds</span><span class="p">[[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">]],</span> <span class="n">MLE_estimates</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">])</span>
<span class="n">results</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(250, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.09327234e-03, 2.02663171e-01],
       [6.64630522e-06, 2.14271447e-01],
       [3.74476058e-03, 5.10057518e-01],
       [6.01875199e-02, 1.67582766e-01]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">results</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">results</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Accuracy</span>
<span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">train_ds</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">probability_multivariate_normal_distribution</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The probability value for multivariate normal distribution function</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    x : array_like</span>
<span class="sd">        the input data</span>
<span class="sd">    mu : array_like</span>
<span class="sd">        the means vector</span>
<span class="sd">    sigma : matrix_like</span>
<span class="sd">        the matrix representing the covariance</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    probability : float</span>
<span class="sd">        the probability value for the x input values </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dimension</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>
    
    <span class="c1">## divide the formula into 2 parts</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="n">dimension</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span>
    
    <span class="c1">## some changes was made to the equation</span>
    <span class="c1">## because of dataset shape</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span> <span class="o">@</span> <span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)))</span>
    
    
    <span class="n">probability</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="n">p2</span>
    
    <span class="k">return</span> <span class="n">probability</span>

<span class="k">def</span> <span class="nf">roc_curve</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    draw the roc curve</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    y : array_like</span>
<span class="sd">        the actual output for the data</span>
<span class="sd">    y_pred : array_like</span>
<span class="sd">        the predicted output for data</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1">## find the values for each threshold</span>
    <span class="c1">## TP -&gt; True Positive</span>
    <span class="c1">## TN -&gt; True Negative</span>
    <span class="c1">## FP -&gt; False Positive</span>
    <span class="c1">## FN -&gt; False Negative</span>
    <span class="k">for</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">):</span>
        <span class="n">TP</span> <span class="o">=</span> <span class="p">((</span><span class="n">y_pred</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">TN</span> <span class="o">=</span> <span class="p">((</span><span class="n">y_pred</span> <span class="o">&lt;=</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">FP</span> <span class="o">=</span> <span class="p">((</span><span class="n">y_pred</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">FN</span> <span class="o">=</span> <span class="p">((</span><span class="n">y_pred</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">threshold</span><span class="p">,</span> <span class="n">TP</span><span class="p">,</span> <span class="n">TN</span><span class="p">,</span> <span class="n">FP</span><span class="p">,</span> <span class="n">FN</span><span class="p">])</span>

    <span class="n">df_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;TP&#39;</span><span class="p">,</span> <span class="s1">&#39;TN&#39;</span><span class="p">,</span> <span class="s1">&#39;FP&#39;</span><span class="p">,</span> <span class="s1">&#39;FN&#39;</span><span class="p">]</span>
    <span class="n">df_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">df_cols</span><span class="p">)</span>

    <span class="c1">## sensitivity and specificity</span>
    <span class="c1">## True Positive rate = sensitivity</span>
    <span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;sens&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_scores</span><span class="o">.</span><span class="n">TP</span> <span class="o">/</span> <span class="p">(</span><span class="n">df_scores</span><span class="o">.</span><span class="n">TP</span> <span class="o">+</span> <span class="n">df_scores</span><span class="o">.</span><span class="n">FN</span><span class="p">)</span>
    <span class="c1">## False Positive rate = 1 - specificity</span>
    <span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;1-spec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_scores</span><span class="o">.</span><span class="n">FP</span> <span class="o">/</span> <span class="p">(</span><span class="n">df_scores</span><span class="o">.</span><span class="n">FP</span> <span class="o">+</span> <span class="n">df_scores</span><span class="o">.</span><span class="n">TN</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;sens&#39;</span><span class="p">],</span> <span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;1-spec&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;sens&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;1-spec&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ROC Curve&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roc_curve</span><span class="p">(</span><span class="n">train_ds</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_77_0.png" src="../_images/main_77_0.png" />
</div>
</div>
<p>Now we’re going to apply the estimations on test set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## test set</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">predict_NB</span><span class="p">(</span><span class="n">test_ds</span><span class="p">[[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">]],</span> <span class="n">MLE_estimates</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">])</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">results</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">results</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## test accuracy</span>
<span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">test_ds</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.91
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roc_curve</span><span class="p">(</span><span class="n">test_ds</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_81_0.png" src="../_images/main_81_0.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="q6">
<h1>Q6<a class="headerlink" href="#q6" title="Permalink to this headline">#</a></h1>
<p>Use Quadratic Discriminant Analysis for <code class="docutils literal notranslate"><span class="pre">classification</span></code> data. The functions for question 5 can be used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## we need to find the mean and covariance of each class</span>

<span class="c1">## divide into class 0 and class 1</span>
<span class="n">train_ds_C0</span> <span class="o">=</span> <span class="n">train_ds</span><span class="p">[</span><span class="n">train_ds</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">train_ds_C1</span> <span class="o">=</span> <span class="n">train_ds</span><span class="p">[</span><span class="n">train_ds</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">train_ds_C0_X</span> <span class="o">=</span> <span class="n">train_ds_C0</span><span class="p">[[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">]]</span>
<span class="n">train_ds_C0_Y</span> <span class="o">=</span> <span class="n">train_ds_C0</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span>

<span class="n">train_ds_C1_X</span> <span class="o">=</span> <span class="n">train_ds_C1</span><span class="p">[[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">]]</span>
<span class="n">train_ds_C1_Y</span> <span class="o">=</span> <span class="n">train_ds_C1</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span>

<span class="n">mu0</span><span class="p">,</span> <span class="n">sigma0</span> <span class="o">=</span> <span class="n">find_MLE_Normal_distro</span><span class="p">(</span><span class="n">train_ds_C0_X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">mu1</span><span class="p">,</span> <span class="n">sigma1</span> <span class="o">=</span> <span class="n">find_MLE_Normal_distro</span><span class="p">(</span><span class="n">train_ds_C1_X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## take a look at properties found</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Class 0&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Covariance:</span><span class="se">\n</span><span class="si">{</span><span class="n">sigma0</span><span class="si">}</span><span class="se">\n</span><span class="s1">Mean vector:</span><span class="se">\n</span><span class="si">{</span><span class="n">mu0</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&#39;</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Class 1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Covariance:</span><span class="se">\n</span><span class="si">{</span><span class="n">sigma1</span><span class="si">}</span><span class="se">\n</span><span class="s1">Mean vector:</span><span class="se">\n</span><span class="si">{</span><span class="n">mu1</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Class 0
Covariance:
467.38705057468275
Mean vector:
-48.45892134854999

--------------------
Class 1
Covariance:
917.6585102015431
Mean vector:
74.18317184898
</pre></div>
</div>
</div>
</div>
<p>Implementing The functions above and some other in a Class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">QDA</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Quadratic Discriminant Analysis Class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu0</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu1</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma0</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma1</span> <span class="o">=</span> <span class="kc">None</span>
    
    <span class="n">__</span>
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict the output for the X input</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        ------------</span>
<span class="sd">        X : array_like</span>
<span class="sd">            The data to be appended</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mu0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu0</span>
        <span class="n">mu1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu1</span>
        <span class="n">sigma0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma0</span>
        <span class="n">sigma1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma1</span>
        
        <span class="c1">## check if the model is not learned and the parameters is updated</span>
        <span class="c1">## checking one parameter is enough </span>
        <span class="c1">## because we are assigning a value to all in learning phase </span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sigma0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="s2">&quot;Error! First fit the model on a dataset then try to predict the values!&quot;</span>
        


        <span class="c1">## Find the probabilities for class 0</span>
        <span class="c1">## save them in an array for furthur comparisons</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
            <span class="c1">## Find the predicted Class of each data in class 0</span>
            <span class="n">P_Class0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__probability_multivariate_normal_distribution</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                             <span class="p">,</span><span class="n">mu0</span><span class="p">,</span> <span class="n">sigma0</span><span class="p">)</span>

            <span class="n">P_Class1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__probability_multivariate_normal_distribution</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                                             <span class="p">,</span><span class="n">mu1</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">)</span>
            <span class="c1">## Compare and set the class to highest probability</span>
            <span class="n">P</span> <span class="o">=</span> <span class="n">P_Class1</span> <span class="o">&gt;=</span> <span class="n">P_Class0</span>

            <span class="c1">## Append the number of Class</span>
            <span class="n">prediction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="n">prediction</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Learning the parameters of the model (Binary Classification model!)</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        X : array_like (pandas dataframe is preferred)</span>
<span class="sd">            the input values to be learned, With outputs as label</span>
<span class="sd">        # Y : array_like</span>
<span class="sd">        #     the label for the data (The binary classification task is here)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">## we need to find the mean and covariance of each class</span>

        <span class="n">features_arr</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1">## divide into class 0 and class 1</span>
        <span class="n">train_ds_C0</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">train_ds_C1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

        <span class="c1"># train_ds_C0_X = train_ds_C0[[&#39;X&#39;, &#39;Y&#39;]]</span>
        <span class="n">train_ds_C0_X</span> <span class="o">=</span> <span class="n">train_ds_C0</span><span class="p">[</span><span class="n">features_arr</span><span class="p">]</span>

        <span class="c1"># train_ds_C0_Y = train_ds_C0[[&#39;label&#39;]]</span>

        <span class="n">train_ds_C1_X</span> <span class="o">=</span> <span class="n">train_ds_C1</span><span class="p">[</span><span class="n">features_arr</span><span class="p">]</span>
        <span class="c1"># train_ds_C1_Y = train_ds_C1[[&#39;label&#39;]]</span>

        <span class="n">mu0</span><span class="p">,</span> <span class="n">sigma0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_MLE_Normal_distro</span><span class="p">(</span><span class="n">train_ds_C0_X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="n">mu1</span><span class="p">,</span> <span class="n">sigma1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__find_MLE_Normal_distro</span><span class="p">(</span><span class="n">train_ds_C1_X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        
        <span class="c1">## Save the parameters of the model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu0</span> <span class="o">=</span> <span class="n">mu0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu1</span> <span class="o">=</span> <span class="n">mu1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma0</span> <span class="o">=</span> <span class="n">sigma0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma1</span> <span class="o">=</span> <span class="n">sigma1</span>
            
    <span class="k">def</span> <span class="nf">__probability_multivariate_normal_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The probability value for multivariate normal distribution function</span>

<span class="sd">        Parameters:</span>
<span class="sd">        ------------</span>
<span class="sd">        x : array_like</span>
<span class="sd">            the input data</span>
<span class="sd">        mu : array_like</span>
<span class="sd">            the means vector</span>
<span class="sd">        sigma : matrix_like</span>
<span class="sd">            the matrix representing the covariance</span>

<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        probability : float</span>
<span class="sd">            the probability value for the x input values </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dimension</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>

        <span class="c1">## divide the formula into 2 parts</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="n">dimension</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span>

        <span class="c1">## some changes was made to the equation</span>
        <span class="c1">## because of dataset shape</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span> <span class="o">@</span> <span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)))</span>


        <span class="n">probability</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="n">p2</span>

        <span class="k">return</span> <span class="n">probability</span>

    <span class="k">def</span> <span class="nf">__find_MLE_Normal_distro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        the maximum likelihood estimation for parameters of multivatiate normal distribution</span>
<span class="sd">        the parameters for normal distribution is covariance matrix and mean vector</span>

<span class="sd">        Parameters:</span>
<span class="sd">        ------------</span>
<span class="sd">        X : array_like</span>
<span class="sd">            the X input data vectors</span>

<span class="sd">        Returns:</span>
<span class="sd">        ---------</span>
<span class="sd">        mu : array_like</span>
<span class="sd">            the means vector</span>
<span class="sd">        covariance : matrix_like</span>
<span class="sd">            the matrix representing the covariance</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1">## some changes was made to the ML estimation of covariance</span>
        <span class="c1">## because of dataset shape</span>
        <span class="n">covariance</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="o">-</span><span class="n">mu</span><span class="p">))</span>    

        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">covariance</span>
   
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## convert probabilities to numpy array</span>
<span class="n">model_QDA</span> <span class="o">=</span> <span class="n">QDA</span><span class="p">()</span>

<span class="n">train_ds_X</span> <span class="o">=</span> <span class="n">train_ds</span><span class="p">[[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">]]</span>
<span class="n">train_ds_Y</span> <span class="o">=</span> <span class="n">train_ds</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span>

<span class="n">model_QDA</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_ds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_Y_pred</span> <span class="o">=</span> <span class="n">model_QDA</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_ds</span><span class="p">[[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">]])</span>
<span class="n">train_Y_pred</span> <span class="o">=</span> <span class="n">model_QDA</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">train_ds_X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mu0:</span><span class="se">\n</span><span class="si">{</span><span class="n">model_QDA</span><span class="o">.</span><span class="n">mu0</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mu1:</span><span class="se">\n</span><span class="si">{</span><span class="n">model_QDA</span><span class="o">.</span><span class="n">mu1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mu0:
X   -0.976629
Y   -0.043558
dtype: float64

Mu1:
X    0.015640
Y    0.941562
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Covariance_0:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">model_QDA</span><span class="o">.</span><span class="n">sigma0</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Covariance_1:</span><span class="se">\n</span><span class="s1"> </span><span class="si">{</span><span class="n">model_QDA</span><span class="o">.</span><span class="n">sigma1</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Covariance_0:
           X         Y
X  0.163509  0.040219
Y  0.040219  0.182233

Covariance_1:
           X         Y
X  0.329871  0.092079
Y  0.092079  0.283534
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## test accuracy</span>
<span class="n">test_Y</span> <span class="o">=</span> <span class="n">test_ds</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">acc_test</span> <span class="o">=</span> <span class="p">(</span><span class="n">test_Y</span> <span class="o">==</span> <span class="n">test_Y_pred</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_Y_pred</span><span class="p">)</span>
<span class="n">acc_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_ROC</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="mi">101</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the confusion matrix for each threshold (ROC)</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    y_true : array_like</span>
<span class="sd">        the actual output of inputs</span>
<span class="sd">    y_pred : array_like</span>
<span class="sd">        the predicted values of inputs</span>
<span class="sd">    thresholds : positive integer</span>
<span class="sd">        the count of thresholds to be evaluated between 0 and 1</span>
<span class="sd">        default is 101</span>

<span class="sd">    Returns:</span>
<span class="sd">    ---------</span>
<span class="sd">    df_scores : pandas dataframe</span>
<span class="sd">        dataframe contains the confusion matrix for different thresholds</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">assert</span> <span class="n">thresholds</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Error: Thresholds must be more than 5!&quot;</span> 
    
    <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">## find the values for each threshold</span>
    <span class="c1">## TP -&gt; True Positive</span>
    <span class="c1">## TN -&gt; True Negative</span>
    <span class="c1">## FP -&gt; False Positive</span>
    <span class="c1">## FN -&gt; False Negative</span>
    <span class="k">for</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">thresholds</span><span class="p">):</span>
        <span class="n">TP</span> <span class="o">=</span> <span class="p">((</span><span class="n">y_pred</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">TN</span> <span class="o">=</span> <span class="p">((</span><span class="n">y_pred</span> <span class="o">&lt;=</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">FP</span> <span class="o">=</span> <span class="p">((</span><span class="n">y_pred</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">FN</span> <span class="o">=</span> <span class="p">((</span><span class="n">y_pred</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_true</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        

        <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">threshold</span><span class="p">,</span> <span class="n">TP</span><span class="p">,</span> <span class="n">TN</span><span class="p">,</span> <span class="n">FP</span><span class="p">,</span> <span class="n">FN</span><span class="p">])</span>

    <span class="n">df_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;TP&#39;</span><span class="p">,</span> <span class="s1">&#39;TN&#39;</span><span class="p">,</span> <span class="s1">&#39;FP&#39;</span><span class="p">,</span> <span class="s1">&#39;FN&#39;</span><span class="p">]</span>
    <span class="n">df_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">df_cols</span><span class="p">)</span>

    <span class="c1">## sensitivity and specificity</span>
    <span class="c1">## True Positive rate = sensitivity</span>
    <span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;sens&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_scores</span><span class="o">.</span><span class="n">TP</span> <span class="o">/</span> <span class="p">(</span><span class="n">df_scores</span><span class="o">.</span><span class="n">TP</span> <span class="o">+</span> <span class="n">df_scores</span><span class="o">.</span><span class="n">FN</span><span class="p">)</span>
    <span class="c1">## False Positive rate = 1 - specificity</span>
    <span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;1-spec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_scores</span><span class="o">.</span><span class="n">FP</span> <span class="o">/</span> <span class="p">(</span><span class="n">df_scores</span><span class="o">.</span><span class="n">FP</span> <span class="o">+</span> <span class="n">df_scores</span><span class="o">.</span><span class="n">TN</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df_scores</span>
<span class="k">def</span> <span class="nf">export_ROC_Curve</span><span class="p">(</span><span class="n">df_scores</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    save the roc curve using the dataframe scores</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    df_scores : array_like</span>
<span class="sd">        the results computed for different thresholds</span>
<span class="sd">    description : string</span>
<span class="sd">        the name of the saved file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;sens&#39;</span><span class="p">],</span> <span class="n">df_scores</span><span class="p">[</span><span class="s1">&#39;1-spec&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ROC Curve for </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Q6_QDA_</span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roc_scores</span> <span class="o">=</span> <span class="n">find_ROC</span><span class="p">(</span><span class="n">test_Y_pred</span><span class="p">,</span> <span class="n">test_Y</span><span class="p">)</span>
<span class="n">export_ROC_Curve</span><span class="p">(</span><span class="n">roc_scores</span><span class="p">,</span> <span class="s1">&#39;MLE&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roc_scores</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>threshold</th>
      <th>TP</th>
      <th>TN</th>
      <th>FP</th>
      <th>FN</th>
      <th>sens</th>
      <th>1-spec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00</td>
      <td>62</td>
      <td>35</td>
      <td>3</td>
      <td>0</td>
      <td>1.000000</td>
      <td>0.078947</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.11</td>
      <td>55</td>
      <td>35</td>
      <td>3</td>
      <td>7</td>
      <td>0.887097</td>
      <td>0.078947</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0.22</td>
      <td>55</td>
      <td>35</td>
      <td>3</td>
      <td>7</td>
      <td>0.887097</td>
      <td>0.078947</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0.33</td>
      <td>55</td>
      <td>35</td>
      <td>3</td>
      <td>7</td>
      <td>0.887097</td>
      <td>0.078947</td>
    </tr>
    <tr>
      <th>44</th>
      <td>0.44</td>
      <td>55</td>
      <td>35</td>
      <td>3</td>
      <td>7</td>
      <td>0.887097</td>
      <td>0.078947</td>
    </tr>
    <tr>
      <th>55</th>
      <td>0.55</td>
      <td>55</td>
      <td>35</td>
      <td>3</td>
      <td>7</td>
      <td>0.887097</td>
      <td>0.078947</td>
    </tr>
    <tr>
      <th>66</th>
      <td>0.66</td>
      <td>55</td>
      <td>35</td>
      <td>3</td>
      <td>7</td>
      <td>0.887097</td>
      <td>0.078947</td>
    </tr>
    <tr>
      <th>77</th>
      <td>0.77</td>
      <td>55</td>
      <td>35</td>
      <td>3</td>
      <td>7</td>
      <td>0.887097</td>
      <td>0.078947</td>
    </tr>
    <tr>
      <th>88</th>
      <td>0.88</td>
      <td>55</td>
      <td>35</td>
      <td>3</td>
      <td>7</td>
      <td>0.887097</td>
      <td>0.078947</td>
    </tr>
    <tr>
      <th>100</th>
      <td>1.00</td>
      <td>55</td>
      <td>38</td>
      <td>0</td>
      <td>7</td>
      <td>0.887097</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="q7">
<h1>Q7<a class="headerlink" href="#q7" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## column names are used from ```pima-indians-diabetes.name``` file</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pregnancy_count&#39;</span><span class="p">,</span> <span class="s1">&#39;glucose_test&#39;</span><span class="p">,</span> <span class="s1">&#39;blood_pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;triceps_thickness&#39;</span><span class="p">,</span> <span class="s1">&#39;2h_insulin&#39;</span><span class="p">,</span> <span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;pedi&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">]</span>

<span class="n">df_pima</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../HW1/hw1_data/pima/pima-indians-diabetes.data&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span> <span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
<span class="n">df_pima</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pregnancy_count</th>
      <th>glucose_test</th>
      <th>blood_pressure</th>
      <th>triceps_thickness</th>
      <th>2h_insulin</th>
      <th>mass</th>
      <th>pedi</th>
      <th>age</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>148</td>
      <td>72</td>
      <td>35</td>
      <td>0</td>
      <td>33.6</td>
      <td>0.627</td>
      <td>50</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>85</td>
      <td>66</td>
      <td>29</td>
      <td>0</td>
      <td>26.6</td>
      <td>0.351</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>183</td>
      <td>64</td>
      <td>0</td>
      <td>0</td>
      <td>23.3</td>
      <td>0.672</td>
      <td>32</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>89</td>
      <td>66</td>
      <td>23</td>
      <td>94</td>
      <td>28.1</td>
      <td>0.167</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>137</td>
      <td>40</td>
      <td>35</td>
      <td>168</td>
      <td>43.1</td>
      <td>2.288</td>
      <td>33</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##################### From HW1 #####################</span>
<span class="k">def</span> <span class="nf">divideset2</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fraction</span> <span class="o">=</span> <span class="mf">0.66</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Divide the dataset into train and test with fixed size every run</span>

<span class="sd">    INPUTS:</span>
<span class="sd">    ---------</span>
<span class="sd">    df: pandas dataframe, the dataset that is going to be splitted</span>
<span class="sd">    fraction: the value to divide the dataset, default is 0.66</span>

<span class="sd">    OUTPUTS:</span>
<span class="sd">    ---------</span>
<span class="sd">    train: pandas dataframe, the portion of the dataset for train</span>
<span class="sd">    test: pandas dataframe, the portion of the dataset for test</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.66</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pima_trn</span><span class="p">,</span> <span class="n">df_pima_tst</span> <span class="o">=</span> <span class="n">divideset2</span><span class="p">(</span><span class="n">df_pima</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pima_trn</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(507, 9)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pima_tst</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(261, 9)
</pre></div>
</div>
</div>
</div>
<p>We have modified the script for question 4 and run it here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>python3 scripts/main_2_7.py
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Logistic Regression on housing dataset!
----------------------------------------------------------------------
----------------------------------------------------------------------
Loading Training and Test sets
datasets loaded!
Train set head:
   pregnancy_count  glucose_test  blood_pressure  ...  mass   pedi  age
0                6           148              72  ...  33.6  0.627   50
1                1            85              66  ...  26.6  0.351   31
2                8           183              64  ...  23.3  0.672   32
3                1            89              66  ...  28.1  0.167   21
4                0           137              40  ...  43.1  2.288   33

[5 rows x 8 columns]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Closed Form Training: </span>
 Train Error: 
  Mean Squared Error: 0.1791001059784589
 Test Error: 
  0.6471354166666666
 Final Weights of the closed form training
[ 2.46554784e-02  3.86639820e-03 -4.91162585e-03  5.75161548e-05
  4.78331990e-05  4.18631699e-03  9.80129310e-02 -1.04267995e-03]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Gradient descent For Logistic Regression with T=50 iterations</span>
 Train Errors: 
scripts/main_2_7.py:148: RuntimeWarning: overflow encountered in exp
  y = 1 / (1 + np.exp(-w.T @ x))
  MSE: [395.00014894191975]
 Test Error: 
  MSE: 395.0

 Final wights of Offline Gradient Descent Learning
[[ -12.22417034]
 [  50.06305025]
 [ -46.92348329]
 [  77.92385392]
 [  17.51867599]
 [-122.31863815]
 [   7.4775007 ]
 [  -0.72949004]]
----------------------------------------------------------------------
----------------------------------------------------------------------
<span class=" -Color -Color-Bold">Incremental Learning (Online GD) </span>
  Training Error:
   MSE:[[1.0178211994736963, 0.6510416666666666]]
  Test Error:
   MSE:0.6510416666666666

 Final wights of Incremental Learning
[0.80728208 3.19264994 0.06047742 2.39362356 0.54607482 0.85250314
 1.88412344 2.44401855]
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="q8">
<h1>Q8<a class="headerlink" href="#q8" title="Permalink to this headline">#</a></h1>
<p>Use Naive bayes implemented and used by question 5 for pima dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pima_cols_X</span> <span class="o">=</span> <span class="n">df_pima_trn</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">MLE_estimates_Q8</span> <span class="o">=</span> <span class="n">estimate_MLE_NB</span><span class="p">(</span><span class="n">df_pima_trn</span><span class="p">[</span><span class="n">pima_cols_X</span><span class="p">],</span> <span class="n">df_pima_trn</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">pima_cols_X</span> <span class="p">)</span>
<span class="n">MLE_estimates_Q8</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;pregnancy_count,0&#39;: [3.3827893175074184, 3.075518425354172],
 &#39;pregnancy_count,1&#39;: [4.947058823529412, 3.5616614839076943],
 &#39;glucose_test,0&#39;: [109.9406528189911, 26.209089248154815],
 &#39;glucose_test,1&#39;: [140.91764705882352, 33.11715807809526],
 &#39;blood_pressure,0&#39;: [68.31750741839762, 18.76743713077681],
 &#39;blood_pressure,1&#39;: [69.69411764705882, 21.696312253420487],
 &#39;triceps_thickness,0&#39;: [19.762611275964392, 15.091512038708125],
 &#39;triceps_thickness,1&#39;: [22.605882352941176, 17.416455051886835],
 &#39;2h_insulin,0&#39;: [65.35311572700297, 91.42289286036038],
 &#39;2h_insulin,1&#39;: [103.74705882352941, 139.6904166052542],
 &#39;mass,0&#39;: [30.332640949554893, 7.0884075860170555],
 &#39;mass,1&#39;: [34.94529411764706, 6.658175529684017],
 &#39;pedi,0&#39;: [0.4379050445103858, 0.30617648254103347],
 &#39;pedi,1&#39;: [0.5496176470588235, 0.3501867917274237],
 &#39;age,0&#39;: [31.42433234421365, 11.96313829923815],
 &#39;age,1&#39;: [36.67058823529412, 10.740126229178365]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_Q8</span> <span class="o">=</span> <span class="n">predict_NB</span><span class="p">(</span><span class="n">df_pima_trn</span><span class="p">[</span><span class="n">pima_cols_X</span><span class="p">],</span> <span class="n">MLE_estimates_Q8</span><span class="p">,</span> <span class="n">pima_cols_X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_Q8</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(507, 2)
</pre></div>
</div>
</div>
</div>
<p>training set accuracy</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">results_Q8</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">results_Q8</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="c1">## Accuracy</span>
<span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">df_pima_trn</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.757396449704142
</pre></div>
</div>
</div>
</div>
<p>Training ROC</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roc_curve</span><span class="p">(</span><span class="n">df_pima_trn</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_110_0.png" src="../_images/main_110_0.png" />
</div>
</div>
<p>Test accuracy and ROC curve</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_Q8_tst</span> <span class="o">=</span> <span class="n">predict_NB</span><span class="p">(</span><span class="n">df_pima_tst</span><span class="p">[</span><span class="n">pima_cols_X</span><span class="p">],</span> <span class="n">MLE_estimates_Q8</span><span class="p">,</span> <span class="n">pima_cols_X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">results_Q8_tst</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">results_Q8_tst</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="c1">## Accuracy</span>
<span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">df_pima_tst</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7624521072796935
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roc_curve</span><span class="p">(</span><span class="n">df_pima_tst</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_114_0.png" src="../_images/main_114_0.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="q9">
<h1>Q9<a class="headerlink" href="#q9" title="Permalink to this headline">#</a></h1>
<p>Use QDA implemented in question 6 for pima dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mode_QDA_pima</span> <span class="o">=</span> <span class="n">QDA</span><span class="p">()</span>
<span class="c1">## the dataframe with the output value will be sent</span>
<span class="c1">## the output column is named &#39;label&#39;</span>
<span class="n">mode_QDA_pima</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_pima_trn</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_Q9</span> <span class="o">=</span> <span class="n">mode_QDA_pima</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_pima_trn</span><span class="p">[</span><span class="n">pima_cols_X</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## accuracy</span>
<span class="p">(</span><span class="n">results_Q9</span> <span class="o">==</span> <span class="n">df_pima_trn</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">results_Q9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7554240631163708
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_Q9</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">results_Q9</span><span class="p">)</span>

<span class="n">roc_curve</span><span class="p">(</span><span class="n">df_pima_trn</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">results_Q9</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_119_0.png" src="../_images/main_119_0.png" />
</div>
</div>
<p>Let’s take a look at the test set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_Q9_tst</span> <span class="o">=</span> <span class="n">mode_QDA_pima</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_pima_tst</span><span class="p">[</span><span class="n">pima_cols_X</span><span class="p">])</span>
<span class="c1">## accuracy</span>
<span class="p">(</span><span class="n">results_Q9_tst</span> <span class="o">==</span> <span class="n">df_pima_tst</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">results_Q9_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7586206896551724
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## ROC curve</span>
<span class="n">results_Q9</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">results_Q9</span><span class="p">)</span>

<span class="n">roc_curve</span><span class="p">(</span><span class="n">df_pima_tst</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">results_Q9_tst</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_122_0.png" src="../_images/main_122_0.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="q10">
<h1>Q10<a class="headerlink" href="#q10" title="Permalink to this headline">#</a></h1>
<p>Use SVM method to predict the outputs of pima dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_svm</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">()</span>

<span class="n">model_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_pima_trn</span><span class="p">[</span><span class="n">pima_cols_X</span><span class="p">],</span> <span class="n">df_pima_trn</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SVC()
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_Q10</span> <span class="o">=</span> <span class="n">model_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_pima_trn</span><span class="p">[</span><span class="n">pima_cols_X</span><span class="p">])</span>
<span class="c1">## Training Accuracy</span>
<span class="p">(</span><span class="n">results_Q10</span> <span class="o">==</span> <span class="n">df_pima_trn</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">results_Q10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7633136094674556
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_Q10_tst</span> <span class="o">=</span> <span class="n">model_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_pima_tst</span><span class="p">[</span><span class="n">pima_cols_X</span><span class="p">])</span>
<span class="c1">## Test accuracy</span>
<span class="p">(</span><span class="n">results_Q10_tst</span> <span class="o">==</span> <span class="n">df_pima_tst</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">results_Q10_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7509578544061303
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Train ROC curve</span>
<span class="n">roc_curve</span><span class="p">(</span><span class="n">df_pima_trn</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">results_Q10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_128_0.png" src="../_images/main_128_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Test ROC curve</span>
<span class="n">roc_curve</span><span class="p">(</span><span class="n">df_pima_tst</span><span class="p">[[</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">results_Q10_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/main_129_0.png" src="../_images/main_129_0.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./HW2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../HW1/main.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">HomeWork #1 Machine Learning</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../HW3/main.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Homework no.3 Machine Learning</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Jupyter Book community<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>